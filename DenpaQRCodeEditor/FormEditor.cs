using System;
using System.Globalization;
using System.Collections;
using System.ComponentModel;
using System.Drawing;
using System.Drawing.Imaging;
using System.IO;
using System.Net;
using System.Text;
using System.Windows.Forms;
using PushmoLevelEditor.Properties;
using com.google.zxing;
using com.google.zxing.qrcode;
using com.google.zxing.common;

/*
 * Todolist:
 * 
 * TODO: add undo/redo
 * TODO: figure out the rest of the flags of the pushmo...
 * TODO: make drawing even faster by using draw-per-change instead of draw-the-all-thing-on-every-change
 */

namespace PushmoLevelEditor
{
    public partial class FormEditor : Form
    {
        private byte[] QRByteArray;
        private Bitmap qr_code;

        private String[][] strStats = new String[49][];
        private int[][] intStats = new int[49][];

        private bool populating = false;

        #region denpa_men_enums
        enum AntennaPower
        {
            no_antenna = 0,
            recover_single,
            revive_single,
            cure_poison,
            cure_burn,
            cure_paralysis,
            cure_frozen,
            attack_fire_single,
            attack_water_single,
            attack_ice_single,
            attack_earth_single,
            attack_wind_single,
            attack_light_single,
            recover_all,
            revive_all,
            bonus_always_treasure,
            bonus_double_gold,
            buff_invincible,
            debuff_fatal,
            attack_fire_all,
            attack_water_all,
            attack_ice_all,
            attack_earth_all,
            attack_wind_all,
            attack_light_all,
            cure_sleep,
            cure_blind,
            buff_excitement,
            buff_attack_all,
            buff_defense_all,
            buff_speed_all,
            debuff_attack_all,
            buff_evasion_all,
            debuff_defense_all,
            debuff_speed_all,
            buff_attack_single,
            buff_defense_single,
            buff_speed_single,
            buff_evasion_single,
            debuff_poison,
            debuff_sleep,
            debuff_paralysis,
            debuff_blind,
            debuff_attack_single,
            debuff_defense_single,
            debuff_speed_single
        };
        #endregion
        #region denpa_men_resources
        Bitmap[] head = new Bitmap[24] { 
            Resources.head_0_0, Resources.head_0_1, Resources.head_0_2, Resources.head_0_3,
            Resources.head_0_4, Resources.head_0_5, Resources.head_0_6, Resources.head_0_7,
            Resources.head_0_8, Resources.head_0_9, Resources.head_0_A, Resources.head_1_0,
            Resources.head_1_1, Resources.head_1_2, Resources.head_1_3, Resources.head_1_4,
            Resources.head_1_5, Resources.head_1_6, Resources.head_2_0, Resources.head_2_1,
            Resources.head_2_2, Resources.head_2_3, Resources.head_2_4, Resources.head_2_5,
        };
        Bitmap[] faceshape = new Bitmap[32] {
            Resources.face_shape_0, Resources.face_shape_1, Resources.face_shape_2, Resources.face_shape_3,
            Resources.face_shape_4, Resources.face_shape_5, Resources.face_shape_6, Resources.face_shape_7,
            Resources.face_shape_8, Resources.hair_style_00,Resources.hair_style_01,Resources.hair_style_02,
            Resources.hair_style_03,Resources.hair_style_04,Resources.hair_style_05,Resources.hair_style_06,
            Resources.hair_style_07,Resources.hair_style_08,Resources.hair_style_09,Resources.hair_style_0A,
            Resources.hair_style_0B,Resources.hair_style_0C,Resources.hair_style_0D,Resources.hair_style_0E,
            Resources.hair_style_0F,Resources.hair_style_10,Resources.hair_style_11,Resources.hair_style_12,
            Resources.hair_style_13,Resources.hair_style_14,Resources.hair_style_15,Resources.hair_style_16
        };
        Bitmap[] haircolor = new Bitmap[12] {
            Resources.hair_color_0, Resources.hair_color_1, Resources.hair_color_2, Resources.hair_color_3,
            Resources.hair_color_4, Resources.hair_color_5, Resources.hair_color_6, Resources.hair_color_7,
            Resources.hair_color_8, Resources.hair_color_9, Resources.hair_color_A, Resources.hair_color_B
        };
        Bitmap[] cheek = new Bitmap[8] {
            Resources.cheek_0, Resources.cheek_1, Resources.cheek_2, Resources.cheek_3,
            Resources.cheek_4, Resources.cheek_5, Resources.cheek_6, Resources.cheek_7
        };
        Bitmap[] face_color = new Bitmap[6] {
            Resources.face_color_4, Resources.face_color_5, Resources.face_color_0,
            Resources.face_color_1, Resources.face_color_2, Resources.face_color_3
        };
        Bitmap[] eye_brow = new Bitmap[8] {
            Resources.eye_brow_0, Resources.eye_brow_1, Resources.eye_brow_2, Resources.eye_brow_3,
            Resources.eye_brow_4, Resources.eye_brow_5, Resources.eye_brow_6, Resources.eye_brow_7
        };
        Bitmap[] eyes = new Bitmap[32] {
            Resources.eyes_00, Resources.eyes_01, Resources.eyes_02, Resources.eyes_03,
            Resources.eyes_04, Resources.eyes_05, Resources.eyes_06, Resources.eyes_07,
            Resources.eyes_08, Resources.eyes_09, Resources.eyes_0A, Resources.eyes_0B,
            Resources.eyes_0C, Resources.eyes_0D, Resources.eyes_0E, Resources.eyes_0F,
            Resources.eyes_10, Resources.eyes_11, Resources.eyes_12, Resources.eyes_13,
            Resources.eyes_14, Resources.eyes_15, Resources.eyes_16, Resources.eyes_17,
            Resources.eyes_18, Resources.eyes_19, Resources.eyes_1A, Resources.eyes_1B,
            Resources.eyes_1C, Resources.eyes_1D, Resources.eyes_1E, Resources.eyes_1F
        };
        Bitmap[] glasses = new Bitmap[16] {
            Resources.glasses_0, Resources.glasses_1, Resources.glasses_2, Resources.glasses_3,
            Resources.glasses_4, Resources.glasses_5, Resources.glasses_6, Resources.glasses_7,
            Resources.glasses_8, Resources.glasses_9, Resources.glasses_A, Resources.glasses_B,
            Resources.glasses_C, Resources.glasses_D, Resources.glasses_E, Resources.glasses_F
        };
        Bitmap[] mouth = new Bitmap[32] {
            Resources.mouth_00, Resources.mouth_01, Resources.mouth_02, Resources.mouth_03,
            Resources.mouth_04, Resources.mouth_05, Resources.mouth_06, Resources.mouth_07,
            Resources.mouth_08, Resources.mouth_09, Resources.mouth_0A, Resources.mouth_0B,
            Resources.mouth_0C, Resources.mouth_0D, Resources.mouth_0E, Resources.mouth_0F,
            Resources.mouth_10, Resources.mouth_11, Resources.mouth_12, Resources.mouth_13,
            Resources.mouth_14, Resources.mouth_15, Resources.mouth_16, Resources.mouth_17,
            Resources.mouth_18, Resources.mouth_19, Resources.mouth_1A, Resources.mouth_1B,
            Resources.mouth_1C, Resources.mouth_1D, Resources.mouth_1E, Resources.mouth_1F,
        };
        Bitmap[] nose = new Bitmap[16] {
            Resources.nose_0, Resources.nose_1, Resources.nose_2, Resources.nose_3,
            Resources.nose_4, Resources.nose_5, Resources.nose_6, Resources.nose_7,
            Resources.nose_8, Resources.nose_9, Resources.nose_A, Resources.nose_B,
            Resources.nose_C, Resources.nose_D, Resources.nose_E, Resources.nose_F
        };

        String[] north_america_names = new String[] {
            #region north_america_names
                "Aaden", "Aaron", "Abdiel", "Abel", "Ace", "Adan", "Adonis", "Adrian", "Aedan", 
                "Agustin", "Ahmad", "Ahmed", "Al", "Alden", "Aldo", "Alessandro", "Alicius", 
                "Alijah", "Allan", "Allen", "Alonso", "Alonzo", "Alton", "Amare", "Amari", 
                "Amir", "Anderson", "Andres", "Andrew", "Andy", "Angel", "Angelo", "Antoine", 
                "Antonio", "Antwan", "Archer", "Ari", "Aric", "Ariel", "Armani", "Arnav", 
                "Aron", "Aryan", "Asa", "Ashton", "Atticus", "August", "Austin", "Avery", 
                "Ayaan", "Bailey", "Backham", "Beau", "Benito", "Bennett", "Benson", "Bentlee", 
                "Bently", "Bill", "Blaze", "Bo", "Bobby", "Bort", "Boston", "Braden", 
                "Bradley", "Bradyn", "Brantley", "Braxton", "Brayan", "Braydon", "Brendon", 
                "Brice", "Brock", "Brodie", "Bronn", "Brooks", "Bruce", "Bruno", "Bryan", 
                "Bryslen", "Burt", "Byron", "Cade", "Caden", "Cain", "Cale", "Caleb", "Calen", 
                "Calvin", "Camden", "Camdyn", "Camilo", "Cameron", "Cannon", "Carl", "Carson", 
                "Casen", "Cash", "Cedric", "Chace", "Chaim", "Chance", "Charles", "Charlie", 
                "Chase", "Chester", "Chet", "Chi", "Clayton", "Cody", "Coleman", "Colin", 
                "Collin", "Colten", "Connor", "Conrad", "Cooper", "Corbin", "Cortez", "Cory", 
                "Craig", "Cristian", "Christopher", "Crew", "Cristofer", "Cristopher", 
                "Crystal", "Cyrus", "Dakota", "Dale", "Dalton", "Damarion", "Damian", "Damon", 
                "Dangelo", "Daniel", "Dante", "Darnell", "Dashawn", "Davion", "Davis", 
                "Dayton", "Deangelo", "Deon", "Deshawn", "Desmond", "Destin", "Diego", 
                "Dillan", "Don", "Donald", "Donovan", "Donte", "Dorian", "Dorsey", "Douglas", 
                "Drake", "Draven", "Drew", "Duncan", "Dyluck", "Eden", "Edison", "Efrain", 
                "Efran", "Elias", "Eliseo", "Elisha", "Elvis", "Emmett", "Enzo", "Ernesto", 
                "Ethan", "Evan", "Everett", "Fabian", "Felipe", "Felix", "Felton", "Fernando", 
                "Finn", "Finnegan", "Fisher", "Forest", "Francis", "Frederick", "Fredrick", 
                "Gage", "Garland", "Garrett", "Gary", "Gavin", "Geoffrey", "Gerard", "Gianni", 
                "Gilbert", "Gilliam", "Giovanni", "Giuseppe", "Glenn", "Grady", "Gregory", 
                "Greyson", "Guillermo", "Gunnar", "Gunner", "Gus", "Gustavo", "Haiden", "Hank", 
                "Harley", "Harold", "Harper", "Harrison", "Hassan", "Hayes", "Heath", 
                "Hezekiah", "Holden", "Hollis", "Homer", "Horacio", "Houston", "Hudson", 
                "Hugh", "Hugo", "Hunter", "Ian", "Ibrahim", "Iker", "Irvin", "Irving", 
                "Isaiah", "Ishaan", "Isiah", "Ivan", "Izaiah", "Jabari", "Jackson", "Jaden", 
                "Jadiel", "Jadyn", "Jae", "Jagger", "Jairo", "Jake", "Jakob", "Jamal", "Jamar", 
                "Jamari", "Jamarion", "Jamel", "James", "Jameson", "Jamie", "Jaquan", "Jared", 
                "Jase", "Jasiah", "Jason", "Jasper", "Jaxon", "Jay", "Jayden", "Jaydon", 
                "Jaylin", "Jean", "Jensen", "Jeremiah", "Jermaine", "Jerry", "Jett", "Joaquin", 
                "Joe", "Joel", "Joey", "Jonah", "Jorah", "Jordan", "Jose", "Joseph", "Joshua", 
                "Josiah", "Josue", "Jovanni", "Joziah", "Judah", "Jude", "Julien", "Julius", 
                "Justice", "Justin", "Justus", "Kai", "Kamari", "Kamden", "Kameron", "Kane", 
                "Karter", "Kayden", "Keagan", "Keaton", "Keith", "Kelvin", "Keon", "Keshawn", 
                "Khalil", "Kieran", "Killian", "King", "Kingston", "Kody", "Kolby", "Kole", 
                "Kolton", "Kristian", "Kyler", "Kymani", "Lamar", "Lance", "Landon", "Lane", 
                "Lathan", "Layton", "Legend", "Leigh", "Len", "Lennon", "Lenny", "Leo", "Leon", 
                "Leonard", "Leonardo", "Leonidas", "Leroy", "Lionel", "Louis", "Lucas", 
                "Lucian", "Luis", "Lyric", "Malachi", "Malik", "Manuel", "Marc", "Marcos", 
                "Mario", "Mark", "Markus", "Marley", "Marquis", "Marvin", "Mason", "Mathew", 
                "Matthew", "Mathias", "Matteo", "Mauricio", "Maverick", "Maxim", "Maximo", 
                "Maximiliano", "Maxwell", "Melvin", "Memphis", "Micheal", "Mike", "Mikey", 
                "Miles", "Milo", "Misael", "Monroe", "Montgomery", "Nash", "Nasir", "Nathan", 
                "Neal", "Nestor", "Nicholas", "Nickolas", "Nico", "Nikolas", "Noah", "Noe", 
                "Nolan", "Norman", "Octavio", "Oliver", "Omar", "Pablo", "Parker", "Paul", 
                "Payton", "Pedro", "Phil", "Phillip", "Phoenix", "Quentin", "Rafael", "Ralph", 
                "Ramiro", "Ramon", "Rashad", "Raul", "Ray", "Rayan", "Raymond", "Reed", 
                "Reese", "Reggie", "Reid", "Remy", "Reyes", "Rhett", "Ricardo", "Rick", 
                "Rickon", "Ricky", "Robert", "Roberto", "Rock", "Roderick", "Rodney", 
                "Rodrigo", "Rohan", "Roman", "Ronaldo", "Ronan", "Ronin", "Ronnie", "Ross", 
                "Rowan", "Roy", "Royce", "Ruben", "Rubin", "Rudy", "Russell", "Ryder", "Ryker", 
                "Ryland", "Rylee", "Sage", "Sal", "Sam", "Samir", "Samson", "Samuel", 
                "Santiago", "Santino", "Saul", "Sawyer", "Sean", "Seymour", "Shane", "Shawn", 
                "Sheldon", "Sid", "Sidney", "Silas", "Sincere", "Slade", "Stan", "Stanley", 
                "Stephan", "Stephen", "Sullivan", "Syrio", "Talan", "Tanner", "Tatum", "Teddy", 
                "Terence", "Terrance", "Terrell", "Terrence", "Theodore", "Tim", "Timmy", 
                "Timothy", "Tobias", "Toby", "Trent", "Trenton", "Tristan", "Tyler", "Tyree", 
                "Tyrone", "Ulises", "Uriel", "Valentino", "Vern", "Vernon", "Victor", 
                "Vincent", "Wade", "Walder", "Waldorf", "Wesley", "Winston", "Xander", 
                "Xavier", "Yael", "Yair", "Yandel", "York", "Zack", "Zackarv", "Zachary", 
                "Zaid", "Zaire", "Zander", "Zayne", "Zion"
                #endregion
        };

        String[] jap_names = new String[] {
            #region japanese_names
                "あかね", "あかり", "あきとら", "あさひ", "あおと", "あると", "あずま", "いお", "いかん", 
                "いきる", "いく", "いくお", "いくし", "いくま", "いくまさ", "いくむ", "いさじ", "いざむ", 
                "いちか", "いちき", "いちご", "いちせい", "いちた", "いちだい", "いちと", "いちは", "いちひろ",
                "いちや", "いちよう", "いちる", "いちろ", "いちろうた", "いつお", "いつひと", "いとし", 
                "いっこう", "いっさ", "いっせい", "いぶみ", "いわお", "いった", "うきょう", "うこん", "うしお", 
                "うじやす", "うちゅう", "うてな", "うみたろう", "うみのすけ", "うみや", "うめたろう", "うめじろう", 
                "うゆう", "うめた", "うりゅう", "うん", "えいき", "えいきち", "えいご", "えいし", "えいじ", 
                "えいしゅん", "えいす", "えいすけ", "えいだい", "えいたろう", "えいのすけ", "えいま", "えいや", 
                "えつお", "えつろう", "えにし", "えびぞう", "えんぞう", "おういち", "おういちろう", "おうが", 
                "おうし", "おうしろう", "おうじ", "おうじろう", "おうや", "おおぞら", "おおや", "おと", "おとき", 
                "おとや", "おりと", "かいお", "かいが", "かいき", "かいこう", "かいし", "かいじ", "かいと", 
                "がいと", "かいへい", "かいや", "かおる", "がくた", "がくや", "かげと", "かげひろ", "かざと", 
                "かずお", "かずおみ", "かずき", "かずさ", "かずし", "かずしげ", "かずたか", "かずたけ", 
                "かずただ", "かずちか", "かずと", "かずとら", "かずのすけ", "かずは", "かずひさ", "かずひと", 
                "かずひろ", "かずふみ", "かずまさ", "かずみつ", "かずむ", "かずや", "かずやす", "かつ", 
                "かつあき", "かつお", "かつじ", "かつと", "かつなり", "かつひこ", "かつひと", "かつら", 
                "かなた", "かなと", "かなで", "かなや", "がもん", "かをる", "かんいち", "かんくろう", "がんじ", 
                "かんすけ", "かんぞう", "かんたろう", "ぎいちろう", "きおのすけ", "きくたろう", "きさぶろう", 
                "きしん", "きっぺい", "きひと", "きひろ", "きみのぶ", "きょうが", "きょうき", "きょうじろう", 
                "きょうすけ", "ぎょうすけ", "きょうたろう", "きょうと", "きょうま", "きよし", "きよしげ", "きよすみ", 
                "きよた", "きよと", "きよなり", "きよのり", "きよのぶ", "きよひと", "きよひら", "きよふみ", 
                "きよま", "きりや", "ぎんが", "きんじろう", "ぎんじろう", "きんたろう", "ぎんと", "きんぺい", 
                "くうご", "くうと", "くすお", "くにとりまる", "くにのり", "くにひこ", "くにひで", "くにひと", 
                "くまたろう", "くらのすけ", "くらま", "くろうど", "くんた", "けい", "けいいちろう", "けいえつ", 
                "けいか", "けいじ", "けいじゅ", "けいしん", "けいすけ", "けいた", "けいだい", "けいん", 
                "けんいちすけ", "けんいちろう", "けんき", "げんき", "けんさく", "けんしろう", "けんじ", "げんじ", 
                "けんすけ", "げんすけ", "けんせい", "けんた", "けんたすけ", "けんたひ", "けんたひこ", 
                "げんたろう", "げんと", "げんのすけ", "けんま", "げんき", "こいちろう", "こう", "こういち", 
                "こういちろう", "こうえい", "こうえつ", "こうお", "こうし", "こうじ", "ごうすけ", "こうた", 
                "ごうだい", "ごうたろう", "こうふ", "こうま", "こうめい", "こうよう", "こうりゅう", "ごくう", "こころ", 
                "こじろう", "コタロー", "こてつ", "ことや", "ごろう", "ごんべえ", "さいき", "さいた", "さいと", 
                "さかえ", "さくいち", "さくお", "さくじ", "さくた", "さくたろう", "さくはる", "さくへい", "さくも", 
                "さくや", "さくら", "さだむ", "さだゆき", "さちお", "さちと", "さちひろ", "さちや", "さとゆき", 
                "さとる", "さねひと", "さのすけ", "さへい", "さまのしん", "さわお", "しあら", "しいち", 
                "じいちろう", "しおり", "しげお", "しげかず", "しげき", "しげなり", "しげひこ", "しげひさ", 
                "しげひろ", "しげまつ", "しこう", "しさお", "じじろう", "しずお", "しのすけ", "しのび", "しのぶ", 
                "しひろ", "しゅう", "しゅうう", "しゅうが", "しゅうげつ", "しゅうご", "じゅうたろう", "しゅうのすけ", 
                "しゅうへい", "しゅうや", "しゅうよ", "しゅうわ", "じゅり", "しゅんいち", "じゅんきち", "じゅんすけ", 
                "じゅんせい", "しゅんた", "じゅんのすけ", "しゅんぺい", "しゅんま", "じゅんま", "しょう", 
                "しょうせい", "しょうた", "しょうだい", "じょうた", "しょうのすけ", "しょうりゅう", "しりゅう", "しろと", 
                "しろう", "じろう", "しんいち", "じんいち", "しんご", "しんざぶろう", "しんじ", "じんぺい", 
                "しんめい", "しんや", "すい", "すいた", "すいと", "すけろく", "すずし", "すばる", "すみと", 
                "すみひこ", "すみはる", "せいあ", "せいご", "せいざぶろう", "せいじ", "せいじろう", "せいしん", 
                "せいすけ", "せいたろう", "せいと", "せいよう", "せいら", "せが", "せつお", "せつや", "せな", 
                "せんいちろう", "せんと", "せんま", "せんご", "せいすけ", "せつお", "そういちろう", "そうが", 
                "そうけん", "そうご", "そうし", "そうじろう", "そうせき", "そうた", "そうだい", "そうたろう", 
                "そうと", "そうま", "そうや", "そらお", "そらき", "そらじろう", "そらや", "たいかい", "だいき", 
                "だいごろう", "だいさく", "たいじゅ", "だいしょう", "だいじろう", "だいすけ", "たいち", "たいと", 
                "だいと", "だいもん", "だいや", "たかいち", "たかお", "たかおみ", "たかつぐ", "たかと", 
                "たかとし", "たかな", "たかね", "たかのぶ", "たかひこ", "たかひさ", "たかひろ", "たかま", 
                "たかみち", "たかみつ", "たかむ", "たかゆき　", "たきお　", "たくい", "たくや", "たくし", 
                "たくすけ", "たくた", "たくたろう", "たくのすけ", "たくふみ", "たくむ", "たくろう", "たけお", 
                "たけき", "たけし", "たけじろう", "たけとも", "たけのぶ", "たけひさ", "たけひと", "たけふみ", 
                "たけまつ", "たけみつ", "たけゆき", "たける", "たすけ", "ただあき", "ただずみ", "ただたか", 
                "ただのぶ", "ただむね", "たつ", "たつおみ", "たつし", "たっと", "たつなり", "たつひこ", 
                "たつひさ", "たつひと", "たっぺい", "たつま", "たつや", "たつよし", "たへい", "たみや", 
                "たみひで", "たもつ", "たろう", "ちあき", "ちおん", "ちかと", "ちかひさ", "ちかゆき", "ちせい", 
                "ちづる", "ちづお", "ちとせ", "ちひろ", "ちゅうすけ", "ちょういち", "ちょうた", "つかさ", 
                "つづみ", "つね", "つねのり", "つねひと", "つねゆき", "つねろう", "つばき", "つばさ", 
                "ていた", "ていと", "てつ", "てつき", "てっせい", "てつた", "てつひさ", "てつひで", "てつひと", 
                "てつま", "テル", "てるあき", "てるお", "てるかず", "てると", "てるとし", "てるのり", "てるま", 
                "てるまさ", "てるみ", "てるみち", "てるよし", "てん", "てんいち", "てんさく", "でんじ", 
                "てんせい", "てんたろう", "てんと", "てんどう", "とうじろう", "とうた", "とうたろう", "とうま", 
                "とうや", "とおる", "ときつぐ", "ときじろう", "ときと", "ときひさ", "ときむね", "ときや", "とくひろ", 
                "としいえ", "としたか", "としなり", "としのぶ", "としまさ", "としみち", "としやす", "としゆき", 
                "とま", "とみお", "とみなり", "とみひさ", "ともかず", "ともき", "ともし", "ともたろう", "ともちか", 
                "ともと", "とものすけ", "とものり", "ともひで", "ともひと", "ともみつ", "ともゆき", "ともよし", 
                "ともろう", "とよき", "とらきち", "とらじろう", "とらひと", "とらお", "なおえ", "なおかず", 
                "なおざね", "なおじろう", "なおた", "なおたか", "なおたろう", "なおとし", "なおはる", 
                "なおひこ", "なおひろ", "なおま", "ながひさ", "なぎと", "なごみ", "なごむ", "なつ", 
                "なついち", "なつお", "なつた", "なつたろう", "なつひと", "なつめ", "ななき", "ななせ", 
                "ななみ", "なゆた", "なり", "なりたつ", "なりひろ", "なりゆき", "なるひと", "なるみ", 
                "にじひこ", "にじや", "にじろう", "にや", "にんざぶろう", "ねおん", "のあ", "ノエル", "のびた", 
                "のぶお", "のぶき", "のぶたか", "のぶてる", "のぶなが", "のぶひろ", "のりかず", "のりたか", 
                "のりひと", "のりゆき", "のりまさ", "はいとく", "はかる", "ばく", "はじめ", "はちろう", "はつき", 
                "はづき", "はつね", "はつま", "ははや", "はやき", "はやたか", "はやと", "はやとし", 
                "はやとも", "はやぶさ", "はゆま", "はゆる", "はるあき", "はるお", "はるか", "はるかず", 
                "はるきよ", "はるすけ", "はるたけ", "はるただ", "はるたろう", "はるとも", "はるとら", "はるなお", 
                "はるなり", "はるね", "はるのり", "はるひ", "はるひこ", "はるひで", "はるま", "はるみち", 
                "はるむ", "はんた", "ばんたろう", "ばんり", "ひかり", "ひかる", "ひこの", "ひさ", "ひさあき", 
                "ひさお", "ひさたか", "ひさのり", "ひさのぶ", "ひさひろ", "ひさや", "ひさよし", "ひじり", 
                "ピッド", "ひづき", "ひさはろ", "ひで", "ひでちか", "ひでとし", "ひでとも", "ひでなり", 
                "ひでひさ", "ひでゆき", "ひでよし", "ひなき", "ひなた", "ひなと", "ひのき", "ひゅう", "ひょう", 
                "ひょうえ", "ひょうが", "ひらお", "ひろかつ", "ひろさき", "ひろき", "ひろこ", "ひろたろう", 
                "ひろひこ", "ひろひで", "ひろまさ", "ひろみつ", "びん", "ふうすけ", "ふうたろう", "ふうと", 
                "ふきち", "ふく", "ふくすけ", "ふくと", "ふくや", "ふじお", "ふたば", "ぶどう", "ふみたけ", 
                "ふみひさ", "ふみひと", "ふゆ", "ふゆと", "ぶんじ", "ぶんたろう", "ぶんや", "べんぞう", 
                "へいた", "へんたい", "ポール", "ほずき", "ほづみ", "ほまれ", "ほうせい", "ほの", "マイケル", 
                "まいじろう", "まいたろう", "まお", "まきた", "まこ", "まさ", "まさおみ", "まさかつ", "まさかど", 
                "まさき", "まさじ", "まさしげ", "まさた", "まこと", "まさたか", "まさただ", "まさちか", "まさと", 
                "まさひろ", "まさほ", "まさむね", "まさみ", "まさみつ", "まさゆき", "まさゆみ", "まさよし", 
                "まさる", "ますお", "またさぶろう", "またざぶろう", "まつたろう", "まどか", "まなつ", "まなと", 
                "まなぶ", "まはる", "まほ", "まみち", "まもる", "まゆき", "まるも", "まれすけ", "まんえい", 
                "まんじろう", "まんぺい", "みお", "みおと", "みかど", "みき", "みきたろう", "みきたか", "みく", 
                "みくや", "みこと", "みさきまる", "みずと", "みずほ", "みずや", "みち", "みちお", "みちき", 
                "みちた", "みちと", "みちなり", "みちはる", "みちひこ", "みちひと", "みちまさ", "みちる", 
                "みちろう", "みつあき", "みつお", "みつき", "みつくに", "みつたか", "みつと", "みつなが", 
                "みつはる", "みつひこ", "みつひさ", "みつひで", "みつまさ", "みつろう", "みどう", "みどり", 
                "みのや", "みのる", "みやび", "みゆき", "みわたくろう", "むが", "むくなが", "むつお", 
                "むつや", "むねお", "むさし", "むねじ", "めいとく", "めかのすけ", "めぐむ", "メグウィン", 
                "もとき", "もぎき", "もときよ", "もとのり", "もとのぶ", "もとひろ", "モンきち", "もんきゅー", 
                "やいち", "やいちろう", "やくも", "やすあき", "やすお", "やすさぶろう", "やすし", "やすとし", 
                "やすなり", "やすひこ", "やすひで", "やすひと", "やすひろ", "やすま", "やすまさ", "やすや", 
                "やすろう", "やひこ", "やまと", "やわら", "ゆいいちろう", "ゆいのすけ", "ゆいと", "ゆいや", 
                "ゆう", "ゆうあ", "ゆうあき", "ゆういち", "ゆうさ", "ゆうさく", "ゆうざぶろう", "ゆうじゅ", 
                "ゆうしょう", "ゆうしん", "ゆうせい", "ゆうだい", "ゆうほ", "ゆうま", "ゆうや", "ゆかり", 
                "ゆきお", "ゆきち", "ゆきとも", "ゆきとら", "ゆきのしん", "ゆきのぶ", "ゆきひと", "ゆきま", 
                "ゆきのすけ", "ゆずる", "ゆみと", "ゆめ", "ゆめき", "ゆめじ", "ゆめた", "ゆらい", "ユウナ", 
                "よういち", "ようく", "ようたろう", "ようと", "よこたる", "よしいえ", "よしお", "よしき", "よしくに", 
                "よした", "よしたろう", "よしちか", "よしつぐ", "よしなお", "よしひこ", "よしひろ", "よしまさ", 
                "よしみつ", "よみ", "よりひと", "ヨン", "らいじ", "らいち", "らいと", "らいな", "ライヤ", "らん", 
                "らんた", "らんぽ", "らんのすけ", "ライト", "りおと", "りきあ", "りきいち", "りきお", "りきと", 
                "りく", "りくたろう", "りくと", "りくのすけ", "りくひろ", "りくへい", "りくみ", "りくや", "りたろう", 
                "りつき", "りつし", "りつじ", "りつたろう", "りつと", "りっと　", "りつま", "りと", "りゅう", 
                "りゅういち", "りゅうし", "りゅうすけ", "りゅうじゅ", "りゅうた", "りゅうたろう", "りゅうだい", 
                "りゅうのすけ", "りゅうほ", "りゅうほう", "りょうい", "りょうえい", "りょうすけ", "りょうた", 
                "りょうたろう", "りょうのしん", "りょうのすけ", "りょうご", "りょうこう", "りょうじろう", "りょうふう", 
                "りょうま", "りょうきち", "りょお", "りんいち", "りんいちろう", "りんご", "りんぞう", "りんた", 
                "りんや", "りくや", "りつき", "りくみ", "ルイス", "るうま", "るおん", "るか", "るきあ", "るな", 
                "るり", "るろ", "れいいち", "れいき", "れいし", "れいのすけ", "れいや", "れいめい", "レイン", 
                "れお", "れき", "レン", "れんいちろう", "れんじ", "れんじゅ", "えいき", "えいき", "えいき", 
                "れんじゅ", "れんじろう", "れんたろう", "れんぺい", "れんま", "れんや", "レレレのおじさん", 
                "ろうた", "ろく", "ろくろう", "ろまん", "ろん", "わいち", "わかき", "わかぎ", "わかさぎ", 
                "わかと", "わかな", "わかひろ", "わく", "わしひと", "わりと"
            #endregion
        };

        #endregion

        public String[] AddItemToArray(String[] original, String itemToAdd)
        {

            String[] finalArray = new String[original.Length + 1];
            for (int i = 0; i < original.Length; i++)
            {
                finalArray[i] = original[i];
            }

            finalArray[finalArray.Length - 1] = itemToAdd;

            return finalArray;
        }

        public void update_names()
        {
            StreamReader name;
            String line;
            bool inside_area;
            if (File.Exists("jap_names.txt"))
            {
                jap_names = new String[0];
                name = new StreamReader("jap_names.txt");
                inside_area = false;
                while ((line = name.ReadLine()) != null)
                {
                    if (line == "#areaedit")
                        inside_area = true;
                    else if (line == "#areaedit(end)")
                        inside_area = false;
                    else
                    {
                        if (inside_area)
                        {
                            line = line.Replace("（主人公）", "");
                            line = line.Replace("(主人公)", "");
                            line = line.Replace("(公式サイトのＱＲコードにて掲載)", "");
                            if (line != "")
                                jap_names = AddItemToArray(jap_names, line);
                        }
                    }
                }
                name.Close();
            }
            if (File.Exists("na_names.txt"))
            {
                north_america_names = new String[0];
                name = new StreamReader("na_names.txt");
                inside_area = false;
                while ((line = name.ReadLine()) != null)
                {
                    if (line == "%")
                        inside_area = true;
                    else if (line == "")
                        inside_area = false;
                    else
                    {
                        if (inside_area)
                        {
                            line = line.Replace("'''''", "");
                            line = line.Replace(" (hero)", "");
                            line = line.Replace(" (hero's fiance)", "");
                            north_america_names = AddItemToArray(north_america_names, line);
                        }
                    }
                }
                name.Close();
            }
        }

        Int16[][] Decryption_Table = new Int16[256][];
        Int16[][] Encryption_Table = new Int16[256][];

        public FormEditor()
        {
            InitializeComponent();
            menuFileNew_Click(null, null);
            update_names();

            #region encryption_decryption_tables
            Encryption_Table[0x00] = new Int16[256] { 
                0x00, 0x03, 0x04, 0x0F, 0x10, 0x1B, 0x2C, 0x3F, 0x40, 0x53, 0x64, 0x8F, 0x90, 0xBB, 0xDC, 0xFF, 
                0x00, 0x23, 0x44, 0x6F, 0xB0, 0xDB, 0xEC, 0x3F, 0x40, 0x93, 0xA4, 0xEF, 0x30, 0x7B, 0xBC, 0xFF, 
                0x00, 0x43, 0x84, 0xCF, 0x10, 0x5B, 0xEC, 0x3F, 0x40, 0x93, 0x24, 0x4F, 0x90, 0x3B, 0x5C, 0xFF, 
                0x00, 0xA3, 0xC4, 0x6F, 0xF0, 0x1B, 0xAC, 0x3F, 0x40, 0xD3, 0x64, 0xEF, 0x70, 0xFB, 0x7C, 0xFF, 
                0x00, 0x83, 0x04, 0x8F, 0x10, 0x9B, 0x2C, 0xBF, 0xC0, 0x53, 0xE4, 0x0F, 0x90, 0x3B, 0x5C, 0xFF, 
                0x00, 0xA3, 0xC4, 0x6F, 0xB0, 0xDB, 0x6C, 0xBF, 0xC0, 0x13, 0xA4, 0xEF, 0x30, 0x7B, 0xBC, 0xFF, 
                0x00, 0x43, 0x84, 0xCF, 0x10, 0x5B, 0x6C, 0xBF, 0xC0, 0x13, 0x24, 0x4F, 0x90, 0xBB, 0xDC, 0xFF, 
                0x00, 0x23, 0x44, 0x6F, 0x70, 0x9B, 0xAC, 0xBF, 0xC0, 0xD3, 0xE4, 0xEF, 0xF0, 0xFB, 0xFC, 0xFF, 
                0x00, 0x03, 0x04, 0x0F, 0x10, 0x1B, 0x2C, 0x3F, 0x40, 0x53, 0x64, 0x8F, 0x90, 0xBB, 0xDC, 0xFF, 
                0x00, 0x23, 0x44, 0x6F, 0xB0, 0xDB, 0xEC, 0x3F, 0x40, 0x93, 0xA4, 0xEF, 0x30, 0x7B, 0xBC, 0xFF, 
                0x00, 0x43, 0x84, 0xCF, 0x10, 0x5B, 0xEC, 0x3F, 0x40, 0x93, 0x24, 0x4F, 0x90, 0x3B, 0x5C, 0xFF, 
                0x00, 0xA3, 0xC4, 0x6F, 0xF0, 0x1B, 0xAC, 0x3F, 0x40, 0xD3, 0x64, 0xEF, 0x70, 0xFB, 0x7C, 0xFF, 
                0x00, 0x83, 0x04, 0x8F, 0x10, 0x9B, 0x2C, 0xBF, 0xC0, 0x53, 0xE4, 0x0F, 0x90, 0x3B, 0x5C, 0xFF, 
                0x00, 0xA3, 0xC4, 0x6F, 0xB0, 0xDB, 0x6C, 0xBF, 0xC0, 0x13, 0xA4, 0xEF, 0x30, 0x7B, 0xBC, 0xFF, 
                0x00, 0x43, 0x84, 0xCF, 0x10, 0x5B, 0x6C, 0xBF, 0xC0, 0x13, 0x24, 0x4F, 0x90, 0xBB, 0xDC, 0xFF, 
                0x00, 0x23, 0x44, 0x6F, 0x70, 0x9B, 0xAC, 0xBF, 0xC0, 0xD3, 0xE4, 0xEF, 0xF0, 0xFB, 0xFC, 0xFF, 
            };
            Encryption_Table[0x01] = new Int16[256] { 
                0x01, 0x00, 0x05, 0x08, 0x11, 0x18, 0x2D, 0x30, 0x41, 0x50, 0x65, 0x88, 0x91, 0xB8, 0xDD, 0xE0, 
                0x01, 0x20, 0x45, 0x68, 0xB1, 0xD8, 0xED, 0x30, 0x41, 0x90, 0xA5, 0xE8, 0x31, 0x78, 0xBD, 0xC0, 
                0x01, 0x40, 0x85, 0xC8, 0x11, 0x58, 0xED, 0x30, 0x41, 0x90, 0x25, 0x48, 0x91, 0x38, 0x5D, 0xE0, 
                0x01, 0xA0, 0xC5, 0x68, 0xF1, 0x18, 0xAD, 0x30, 0x41, 0xD0, 0x65, 0xE8, 0x71, 0xF8, 0x7D, 0x80, 
                0x01, 0x80, 0x05, 0x88, 0x11, 0x98, 0x2D, 0xB0, 0xC1, 0x50, 0xE5, 0x08, 0x91, 0x38, 0x5D, 0xE0, 
                0x01, 0xA0, 0xC5, 0x68, 0xB1, 0xD8, 0x6D, 0xB0, 0xC1, 0x10, 0xA5, 0xE8, 0x31, 0x78, 0xBD, 0xC0, 
                0x01, 0x40, 0x85, 0xC8, 0x11, 0x58, 0x6D, 0xB0, 0xC1, 0x10, 0x25, 0x48, 0x91, 0xB8, 0xDD, 0xE0, 
                0x01, 0x20, 0x45, 0x68, 0x71, 0x98, 0xAD, 0xB0, 0xC1, 0xD0, 0xE5, 0xE8, 0xF1, 0xF8, 0xFD, 0x00, 
                0x01, 0x00, 0x05, 0x08, 0x11, 0x18, 0x2D, 0x30, 0x41, 0x50, 0x65, 0x88, 0x91, 0xB8, 0xDD, 0xE0, 
                0x01, 0x20, 0x45, 0x68, 0xB1, 0xD8, 0xED, 0x30, 0x41, 0x90, 0xA5, 0xE8, 0x31, 0x78, 0xBD, 0xC0, 
                0x01, 0x40, 0x85, 0xC8, 0x11, 0x58, 0xED, 0x30, 0x41, 0x90, 0x25, 0x48, 0x91, 0x38, 0x5D, 0xE0, 
                0x01, 0xA0, 0xC5, 0x68, 0xF1, 0x18, 0xAD, 0x30, 0x41, 0xD0, 0x65, 0xE8, 0x71, 0xF8, 0x7D, 0x80, 
                0x01, 0x80, 0x05, 0x88, 0x11, 0x98, 0x2D, 0xB0, 0xC1, 0x50, 0xE5, 0x08, 0x91, 0x38, 0x5D, 0xE0, 
                0x01, 0xA0, 0xC5, 0x68, 0xB1, 0xD8, 0x6D, 0xB0, 0xC1, 0x10, 0xA5, 0xE8, 0x31, 0x78, 0xBD, 0xC0, 
                0x01, 0x40, 0x85, 0xC8, 0x11, 0x58, 0x6D, 0xB0, 0xC1, 0x10, 0x25, 0x48, 0x91, 0xB8, 0xDD, 0xE0, 
                0x01, 0x20, 0x45, 0x68, 0x71, 0x98, 0xAD, 0xB0, 0xC1, 0xD0, 0xE5, 0xE8, 0xF1, 0xF8, 0xFD, 0x00, 
            };
            Encryption_Table[0x02] = new Int16[256] { 
                0x02, 0x05, 0x06, 0x09, 0x12, 0x25, 0x2E, 0x31, 0x42, 0x55, 0x66, 0x89, 0x92, 0xB5, 0xDE, 0xE1, 
                0x02, 0x25, 0x46, 0x69, 0xB2, 0xC5, 0xEE, 0x31, 0x42, 0x95, 0xA6, 0xE9, 0x32, 0x75, 0xBE, 0xC1, 
                0x02, 0x45, 0x86, 0xC9, 0x12, 0xA5, 0xEE, 0x31, 0x42, 0x95, 0x26, 0x49, 0x92, 0x35, 0x5E, 0xE1, 
                0x02, 0xA5, 0xC6, 0x69, 0xF2, 0x05, 0xAE, 0x31, 0x42, 0xD5, 0x66, 0xE9, 0x72, 0xF5, 0x7E, 0x81, 
                0x02, 0x85, 0x06, 0x89, 0x12, 0xA5, 0x2E, 0xB1, 0xC2, 0x55, 0xE6, 0x09, 0x92, 0x35, 0x5E, 0xE1, 
                0x02, 0xA5, 0xC6, 0x69, 0xB2, 0xC5, 0x6E, 0xB1, 0xC2, 0x15, 0xA6, 0xE9, 0x32, 0x75, 0xBE, 0xC1, 
                0x02, 0x45, 0x86, 0xC9, 0x12, 0x25, 0x6E, 0xB1, 0xC2, 0x15, 0x26, 0x49, 0x92, 0xB5, 0xDE, 0xE1, 
                0x02, 0x25, 0x46, 0x69, 0x72, 0x85, 0xAE, 0xB1, 0xC2, 0xD5, 0xE6, 0xE9, 0xF2, 0xF5, 0xFE, 0x01, 
                0x02, 0x05, 0x06, 0x09, 0x12, 0x25, 0x2E, 0x31, 0x42, 0x55, 0x66, 0x89, 0x92, 0xB5, 0xDE, 0xE1, 
                0x02, 0x25, 0x46, 0x69, 0xB2, 0xC5, 0xEE, 0x31, 0x42, 0x95, 0xA6, 0xE9, 0x32, 0x75, 0xBE, 0xC1, 
                0x02, 0x45, 0x86, 0xC9, 0x12, 0xA5, 0xEE, 0x31, 0x42, 0x95, 0x26, 0x49, 0x92, 0x35, 0x5E, 0xE1, 
                0x02, 0xA5, 0xC6, 0x69, 0xF2, 0x05, 0xAE, 0x31, 0x42, 0xD5, 0x66, 0xE9, 0x72, 0xF5, 0x7E, 0x81, 
                0x02, 0x85, 0x06, 0x89, 0x12, 0xA5, 0x2E, 0xB1, 0xC2, 0x55, 0xE6, 0x09, 0x92, 0x35, 0x5E, 0xE1, 
                0x02, 0xA5, 0xC6, 0x69, 0xB2, 0xC5, 0x6E, 0xB1, 0xC2, 0x15, 0xA6, 0xE9, 0x32, 0x75, 0xBE, 0xC1, 
                0x02, 0x45, 0x86, 0xC9, 0x12, 0x25, 0x6E, 0xB1, 0xC2, 0x15, 0x26, 0x49, 0x92, 0xB5, 0xDE, 0xE1, 
                0x02, 0x25, 0x46, 0x69, 0x72, 0x85, 0xAE, 0xB1, 0xC2, 0xD5, 0xE6, 0xE9, 0xF2, 0xF5, 0xFE, 0x01, 
            };
            Encryption_Table[0x03] = new Int16[256] { 
                0x03, 0x02, 0x07, 0x0A, 0x13, 0x1A, 0x2F, 0x32, 0x43, 0x52, 0x67, 0x8A, 0x93, 0xBA, 0xDF, 0xE2, 
                0x03, 0x22, 0x47, 0x6A, 0xB3, 0xDA, 0xEF, 0x32, 0x43, 0x92, 0xA7, 0xEA, 0x33, 0x7A, 0xBF, 0xC2, 
                0x03, 0x42, 0x87, 0xCA, 0x13, 0x5A, 0xEF, 0x32, 0x43, 0x92, 0x27, 0x4A, 0x93, 0x3A, 0x5F, 0xE2, 
                0x03, 0xA2, 0xC7, 0x6A, 0xF3, 0x1A, 0xAF, 0x32, 0x43, 0xD2, 0x67, 0xEA, 0x73, 0xFA, 0x7F, 0x82, 
                0x03, 0x82, 0x07, 0x8A, 0x13, 0x9A, 0x2F, 0xB2, 0xC3, 0x52, 0xE7, 0x0A, 0x93, 0x3A, 0x5F, 0xE2, 
                0x03, 0xA2, 0xC7, 0x6A, 0xB3, 0xDA, 0x6F, 0xB2, 0xC3, 0x12, 0xA7, 0xEA, 0x33, 0x7A, 0xBF, 0xC2, 
                0x03, 0x42, 0x87, 0xCA, 0x13, 0x5A, 0x6F, 0xB2, 0xC3, 0x12, 0x27, 0x4A, 0x93, 0xBA, 0xDF, 0xE2, 
                0x03, 0x22, 0x47, 0x6A, 0x73, 0x9A, 0xAF, 0xB2, 0xC3, 0xD2, 0xE7, 0xEA, 0xF3, 0xFA, 0xFF, 0x02, 
                0x03, 0x02, 0x07, 0x0A, 0x13, 0x1A, 0x2F, 0x32, 0x43, 0x52, 0x67, 0x8A, 0x93, 0xBA, 0xDF, 0xE2, 
                0x03, 0x22, 0x47, 0x6A, 0xB3, 0xDA, 0xEF, 0x32, 0x43, 0x92, 0xA7, 0xEA, 0x33, 0x7A, 0xBF, 0xC2, 
                0x03, 0x42, 0x87, 0xCA, 0x13, 0x5A, 0xEF, 0x32, 0x43, 0x92, 0x27, 0x4A, 0x93, 0x3A, 0x5F, 0xE2, 
                0x03, 0xA2, 0xC7, 0x6A, 0xF3, 0x1A, 0xAF, 0x32, 0x43, 0xD2, 0x67, 0xEA, 0x73, 0xFA, 0x7F, 0x82, 
                0x03, 0x82, 0x07, 0x8A, 0x13, 0x9A, 0x2F, 0xB2, 0xC3, 0x52, 0xE7, 0x0A, 0x93, 0x3A, 0x5F, 0xE2, 
                0x03, 0xA2, 0xC7, 0x6A, 0xB3, 0xDA, 0x6F, 0xB2, 0xC3, 0x12, 0xA7, 0xEA, 0x33, 0x7A, 0xBF, 0xC2, 
                0x03, 0x42, 0x87, 0xCA, 0x13, 0x5A, 0x6F, 0xB2, 0xC3, 0x12, 0x27, 0x4A, 0x93, 0xBA, 0xDF, 0xE2, 
                0x03, 0x22, 0x47, 0x6A, 0x73, 0x9A, 0xAF, 0xB2, 0xC3, 0xD2, 0xE7, 0xEA, 0xF3, 0xFA, 0xFF, 0x02, 
            };
            Encryption_Table[0x04] = new Int16[256] { 
                0x04, 0x07, 0x08, 0x13, 0x14, 0x1F, 0x20, 0x33, 0x44, 0x57, 0x78, 0x83, 0x94, 0xBF, 0xC0, 0xE3, 
                0x04, 0x27, 0x48, 0x93, 0xB4, 0xDF, 0xE0, 0x33, 0x44, 0x97, 0xD8, 0xE3, 0x34, 0x7F, 0x80, 0xC3, 
                0x04, 0x47, 0x88, 0xD3, 0x14, 0x5F, 0xE0, 0x33, 0x44, 0x97, 0x38, 0x43, 0x94, 0x3F, 0x40, 0xE3, 
                0x04, 0xA7, 0xC8, 0x53, 0xF4, 0x1F, 0xA0, 0x33, 0x44, 0xD7, 0x58, 0xE3, 0x74, 0xFF, 0x00, 0x83, 
                0x04, 0x87, 0x08, 0x93, 0x14, 0x9F, 0x20, 0xB3, 0xC4, 0x57, 0xF8, 0x03, 0x94, 0x3F, 0x40, 0xE3, 
                0x04, 0xA7, 0xC8, 0x13, 0xB4, 0xDF, 0x60, 0xB3, 0xC4, 0x17, 0x58, 0xE3, 0x34, 0x7F, 0x80, 0xC3, 
                0x04, 0x47, 0x88, 0xD3, 0x14, 0x5F, 0x60, 0xB3, 0xC4, 0x17, 0x38, 0x43, 0x94, 0xBF, 0xC0, 0xE3, 
                0x04, 0x27, 0x48, 0x53, 0x74, 0x9F, 0xA0, 0xB3, 0xC4, 0xD7, 0xD8, 0xE3, 0xF4, 0xFF, 0x00, 0x03, 
                0x04, 0x07, 0x08, 0x13, 0x14, 0x1F, 0x20, 0x33, 0x44, 0x57, 0x78, 0x83, 0x94, 0xBF, 0xC0, 0xE3, 
                0x04, 0x27, 0x48, 0x93, 0xB4, 0xDF, 0xE0, 0x33, 0x44, 0x97, 0xD8, 0xE3, 0x34, 0x7F, 0x80, 0xC3, 
                0x04, 0x47, 0x88, 0xD3, 0x14, 0x5F, 0xE0, 0x33, 0x44, 0x97, 0x38, 0x43, 0x94, 0x3F, 0x40, 0xE3, 
                0x04, 0xA7, 0xC8, 0x53, 0xF4, 0x1F, 0xA0, 0x33, 0x44, 0xD7, 0x58, 0xE3, 0x74, 0xFF, 0x00, 0x83, 
                0x04, 0x87, 0x08, 0x93, 0x14, 0x9F, 0x20, 0xB3, 0xC4, 0x57, 0xF8, 0x03, 0x94, 0x3F, 0x40, 0xE3, 
                0x04, 0xA7, 0xC8, 0x13, 0xB4, 0xDF, 0x60, 0xB3, 0xC4, 0x17, 0x58, 0xE3, 0x34, 0x7F, 0x80, 0xC3, 
                0x04, 0x47, 0x88, 0xD3, 0x14, 0x5F, 0x60, 0xB3, 0xC4, 0x17, 0x38, 0x43, 0x94, 0xBF, 0xC0, 0xE3, 
                0x04, 0x27, 0x48, 0x53, 0x74, 0x9F, 0xA0, 0xB3, 0xC4, 0xD7, 0xD8, 0xE3, 0xF4, 0xFF, 0x00, 0x03, 
            };
            Encryption_Table[0x05] = new Int16[256] { 
                0x05, 0x04, 0x09, 0x0C, 0x15, 0x1C, 0x21, 0x34, 0x45, 0x54, 0x79, 0x8C, 0x95, 0xBC, 0xC1, 0xE4, 
                0x05, 0x24, 0x49, 0x6C, 0xB5, 0xDC, 0xE1, 0x34, 0x45, 0x94, 0xD9, 0xEC, 0x35, 0x7C, 0x81, 0xC4, 
                0x05, 0x44, 0x89, 0xCC, 0x15, 0x5C, 0xE1, 0x34, 0x45, 0x94, 0x39, 0x4C, 0x95, 0x3C, 0x41, 0xE4, 
                0x05, 0xA4, 0xC9, 0x6C, 0xF5, 0x1C, 0xA1, 0x34, 0x45, 0xD4, 0x59, 0xEC, 0x75, 0xFC, 0x01, 0x84, 
                0x05, 0x84, 0x09, 0x8C, 0x15, 0x9C, 0x21, 0xB4, 0xC5, 0x54, 0xF9, 0x0C, 0x95, 0x3C, 0x41, 0xE4, 
                0x05, 0xA4, 0xC9, 0x6C, 0xB5, 0xDC, 0x61, 0xB4, 0xC5, 0x14, 0x59, 0xEC, 0x35, 0x7C, 0x81, 0xC4, 
                0x05, 0x44, 0x89, 0xCC, 0x15, 0x5C, 0x61, 0xB4, 0xC5, 0x14, 0x39, 0x4C, 0x95, 0xBC, 0xC1, 0xE4, 
                0x05, 0x24, 0x49, 0x6C, 0x75, 0x9C, 0xA1, 0xB4, 0xC5, 0xD4, 0xD9, 0xEC, 0xF5, 0xFC, 0x01, 0x04, 
                0x05, 0x04, 0x09, 0x0C, 0x15, 0x1C, 0x21, 0x34, 0x45, 0x54, 0x79, 0x8C, 0x95, 0xBC, 0xC1, 0xE4, 
                0x05, 0x24, 0x49, 0x6C, 0xB5, 0xDC, 0xE1, 0x34, 0x45, 0x94, 0xD9, 0xEC, 0x35, 0x7C, 0x81, 0xC4, 
                0x05, 0x44, 0x89, 0xCC, 0x15, 0x5C, 0xE1, 0x34, 0x45, 0x94, 0x39, 0x4C, 0x95, 0x3C, 0x41, 0xE4, 
                0x05, 0xA4, 0xC9, 0x6C, 0xF5, 0x1C, 0xA1, 0x34, 0x45, 0xD4, 0x59, 0xEC, 0x75, 0xFC, 0x01, 0x84, 
                0x05, 0x84, 0x09, 0x8C, 0x15, 0x9C, 0x21, 0xB4, 0xC5, 0x54, 0xF9, 0x0C, 0x95, 0x3C, 0x41, 0xE4, 
                0x05, 0xA4, 0xC9, 0x6C, 0xB5, 0xDC, 0x61, 0xB4, 0xC5, 0x14, 0x59, 0xEC, 0x35, 0x7C, 0x81, 0xC4, 
                0x05, 0x44, 0x89, 0xCC, 0x15, 0x5C, 0x61, 0xB4, 0xC5, 0x14, 0x39, 0x4C, 0x95, 0xBC, 0xC1, 0xE4, 
                0x05, 0x24, 0x49, 0x6C, 0x75, 0x9C, 0xA1, 0xB4, 0xC5, 0xD4, 0xD9, 0xEC, 0xF5, 0xFC, 0x01, 0x04, 
            };
            Encryption_Table[0x06] = new Int16[256] { 
                0x06, 0x09, 0x0A, 0x0D, 0x16, 0x19, 0x22, 0x35, 0x46, 0x69, 0x7A, 0x8D, 0x96, 0xB9, 0xC2, 0xE5, 
                0x06, 0x29, 0x4A, 0x6D, 0xB6, 0xD9, 0xE2, 0x35, 0x46, 0x89, 0xDA, 0xED, 0x36, 0x79, 0x82, 0xC5, 
                0x06, 0x49, 0x8A, 0xCD, 0x16, 0x59, 0xE2, 0x35, 0x46, 0xE9, 0x3A, 0x4D, 0x96, 0x39, 0x42, 0xE5, 
                0x06, 0xA9, 0xCA, 0x6D, 0xF6, 0x19, 0xA2, 0x35, 0x46, 0xC9, 0x5A, 0xED, 0x76, 0xF9, 0x02, 0x85, 
                0x06, 0x89, 0x0A, 0x8D, 0x16, 0x99, 0x22, 0xB5, 0xC6, 0x69, 0xFA, 0x0D, 0x96, 0x39, 0x42, 0xE5, 
                0x06, 0xA9, 0xCA, 0x6D, 0xB6, 0xD9, 0x62, 0xB5, 0xC6, 0x09, 0x5A, 0xED, 0x36, 0x79, 0x82, 0xC5, 
                0x06, 0x49, 0x8A, 0xCD, 0x16, 0x59, 0x62, 0xB5, 0xC6, 0xE9, 0x3A, 0x4D, 0x96, 0xB9, 0xC2, 0xE5, 
                0x06, 0x29, 0x4A, 0x6D, 0x76, 0x99, 0xA2, 0xB5, 0xC6, 0xC9, 0xDA, 0xED, 0xF6, 0xF9, 0x02, 0x05, 
                0x06, 0x09, 0x0A, 0x0D, 0x16, 0x19, 0x22, 0x35, 0x46, 0x69, 0x7A, 0x8D, 0x96, 0xB9, 0xC2, 0xE5, 
                0x06, 0x29, 0x4A, 0x6D, 0xB6, 0xD9, 0xE2, 0x35, 0x46, 0x89, 0xDA, 0xED, 0x36, 0x79, 0x82, 0xC5, 
                0x06, 0x49, 0x8A, 0xCD, 0x16, 0x59, 0xE2, 0x35, 0x46, 0xE9, 0x3A, 0x4D, 0x96, 0x39, 0x42, 0xE5, 
                0x06, 0xA9, 0xCA, 0x6D, 0xF6, 0x19, 0xA2, 0x35, 0x46, 0xC9, 0x5A, 0xED, 0x76, 0xF9, 0x02, 0x85, 
                0x06, 0x89, 0x0A, 0x8D, 0x16, 0x99, 0x22, 0xB5, 0xC6, 0x69, 0xFA, 0x0D, 0x96, 0x39, 0x42, 0xE5, 
                0x06, 0xA9, 0xCA, 0x6D, 0xB6, 0xD9, 0x62, 0xB5, 0xC6, 0x09, 0x5A, 0xED, 0x36, 0x79, 0x82, 0xC5, 
                0x06, 0x49, 0x8A, 0xCD, 0x16, 0x59, 0x62, 0xB5, 0xC6, 0xE9, 0x3A, 0x4D, 0x96, 0xB9, 0xC2, 0xE5, 
                0x06, 0x29, 0x4A, 0x6D, 0x76, 0x99, 0xA2, 0xB5, 0xC6, 0xC9, 0xDA, 0xED, 0xF6, 0xF9, 0x02, 0x05, 
            };
            Encryption_Table[0x07] = new Int16[256] { 
                0x07, 0x06, 0x0B, 0x0E, 0x17, 0x1E, 0x23, 0x36, 0x47, 0x56, 0x7B, 0x8E, 0x97, 0xBE, 0xC3, 0xE6, 
                0x07, 0x26, 0x4B, 0x6E, 0xB7, 0xDE, 0xE3, 0x36, 0x47, 0x96, 0xDB, 0xEE, 0x37, 0x7E, 0x83, 0xC6, 
                0x07, 0x46, 0x8B, 0xCE, 0x17, 0x5E, 0xE3, 0x36, 0x47, 0x96, 0x3B, 0x4E, 0x97, 0x3E, 0x43, 0xE6, 
                0x07, 0xA6, 0xCB, 0x6E, 0xF7, 0x1E, 0xA3, 0x36, 0x47, 0xD6, 0x5B, 0xEE, 0x77, 0xFE, 0x03, 0x86, 
                0x07, 0x86, 0x0B, 0x8E, 0x17, 0x9E, 0x23, 0xB6, 0xC7, 0x56, 0xFB, 0x0E, 0x97, 0x3E, 0x43, 0xE6, 
                0x07, 0xA6, 0xCB, 0x6E, 0xB7, 0xDE, 0x63, 0xB6, 0xC7, 0x16, 0x5B, 0xEE, 0x37, 0x7E, 0x83, 0xC6, 
                0x07, 0x46, 0x8B, 0xCE, 0x17, 0x5E, 0x63, 0xB6, 0xC7, 0x16, 0x3B, 0x4E, 0x97, 0xBE, 0xC3, 0xE6, 
                0x07, 0x26, 0x4B, 0x6E, 0x77, 0x9E, 0xA3, 0xB6, 0xC7, 0xD6, 0xDB, 0xEE, 0xF7, 0xFE, 0x03, 0x06, 
                0x07, 0x06, 0x0B, 0x0E, 0x17, 0x1E, 0x23, 0x36, 0x47, 0x56, 0x7B, 0x8E, 0x97, 0xBE, 0xC3, 0xE6, 
                0x07, 0x26, 0x4B, 0x6E, 0xB7, 0xDE, 0xE3, 0x36, 0x47, 0x96, 0xDB, 0xEE, 0x37, 0x7E, 0x83, 0xC6, 
                0x07, 0x46, 0x8B, 0xCE, 0x17, 0x5E, 0xE3, 0x36, 0x47, 0x96, 0x3B, 0x4E, 0x97, 0x3E, 0x43, 0xE6, 
                0x07, 0xA6, 0xCB, 0x6E, 0xF7, 0x1E, 0xA3, 0x36, 0x47, 0xD6, 0x5B, 0xEE, 0x77, 0xFE, 0x03, 0x86, 
                0x07, 0x86, 0x0B, 0x8E, 0x17, 0x9E, 0x23, 0xB6, 0xC7, 0x56, 0xFB, 0x0E, 0x97, 0x3E, 0x43, 0xE6, 
                0x07, 0xA6, 0xCB, 0x6E, 0xB7, 0xDE, 0x63, 0xB6, 0xC7, 0x16, 0x5B, 0xEE, 0x37, 0x7E, 0x83, 0xC6, 
                0x07, 0x46, 0x8B, 0xCE, 0x17, 0x5E, 0x63, 0xB6, 0xC7, 0x16, 0x3B, 0x4E, 0x97, 0xBE, 0xC3, 0xE6, 
                0x07, 0x26, 0x4B, 0x6E, 0x77, 0x9E, 0xA3, 0xB6, 0xC7, 0xD6, 0xDB, 0xEE, 0xF7, 0xFE, 0x03, 0x06, 
            };
            Encryption_Table[0x08] = new Int16[256] { 
                0x08, 0x0B, 0x0C, 0x17, 0x18, 0x23, 0x34, 0x47, 0x48, 0x5B, 0x6C, 0x77, 0x98, 0xA3, 0xC4, 0xE7, 
                0x08, 0x2B, 0x4C, 0x97, 0xB8, 0xC3, 0x14, 0x27, 0x48, 0x9B, 0xAC, 0xF7, 0x38, 0x43, 0x84, 0xC7, 
                0x08, 0x4B, 0x8C, 0xD7, 0x18, 0xA3, 0xF4, 0x07, 0x48, 0x9B, 0x2C, 0x77, 0x98, 0x23, 0x44, 0xE7, 
                0x08, 0xAB, 0xCC, 0x57, 0xF8, 0x03, 0x94, 0x27, 0x48, 0xDB, 0x6C, 0xF7, 0x78, 0x83, 0x04, 0x87, 
                0x08, 0x8B, 0x0C, 0x97, 0x18, 0xA3, 0x34, 0x47, 0xC8, 0x5B, 0xEC, 0x77, 0x98, 0x23, 0x44, 0xE7, 
                0x08, 0xAB, 0xCC, 0x17, 0xB8, 0xC3, 0x14, 0xA7, 0xC8, 0x1B, 0xAC, 0xF7, 0x38, 0x43, 0x84, 0xC7, 
                0x08, 0x4B, 0x8C, 0xD7, 0x18, 0x23, 0x74, 0x87, 0xC8, 0x1B, 0x2C, 0x77, 0x98, 0xA3, 0xC4, 0xE7, 
                0x08, 0x2B, 0x4C, 0x57, 0x78, 0x83, 0x94, 0xA7, 0xC8, 0xDB, 0xEC, 0xF7, 0xF8, 0x03, 0x04, 0x07, 
                0x08, 0x0B, 0x0C, 0x17, 0x18, 0x23, 0x34, 0x47, 0x48, 0x5B, 0x6C, 0x77, 0x98, 0xA3, 0xC4, 0xE7, 
                0x08, 0x2B, 0x4C, 0x97, 0xB8, 0xC3, 0x14, 0x27, 0x48, 0x9B, 0xAC, 0xF7, 0x38, 0x43, 0x84, 0xC7, 
                0x08, 0x4B, 0x8C, 0xD7, 0x18, 0xA3, 0xF4, 0x07, 0x48, 0x9B, 0x2C, 0x77, 0x98, 0x23, 0x44, 0xE7, 
                0x08, 0xAB, 0xCC, 0x57, 0xF8, 0x03, 0x94, 0x27, 0x48, 0xDB, 0x6C, 0xF7, 0x78, 0x83, 0x04, 0x87, 
                0x08, 0x8B, 0x0C, 0x97, 0x18, 0xA3, 0x34, 0x47, 0xC8, 0x5B, 0xEC, 0x77, 0x98, 0x23, 0x44, 0xE7, 
                0x08, 0xAB, 0xCC, 0x17, 0xB8, 0xC3, 0x14, 0xA7, 0xC8, 0x1B, 0xAC, 0xF7, 0x38, 0x43, 0x84, 0xC7, 
                0x08, 0x4B, 0x8C, 0xD7, 0x18, 0x23, 0x74, 0x87, 0xC8, 0x1B, 0x2C, 0x77, 0x98, 0xA3, 0xC4, 0xE7, 
                0x08, 0x2B, 0x4C, 0x57, 0x78, 0x83, 0x94, 0xA7, 0xC8, 0xDB, 0xEC, 0xF7, 0xF8, 0x03, 0x04, 0x07, 
            };
            Encryption_Table[0x09] = new Int16[256] { 
                0x09, 0x08, 0x0D, 0x10, 0x19, 0x20, 0x35, 0x38, 0x49, 0x58, 0x6D, 0x70, 0x99, 0xA0, 0xC5, 0xE8, 
                0x09, 0x28, 0x4D, 0x90, 0xB9, 0xC0, 0x15, 0x38, 0x49, 0x98, 0xAD, 0xF0, 0x39, 0x40, 0x85, 0xC8, 
                0x09, 0x48, 0x8D, 0xD0, 0x19, 0xA0, 0xF5, 0x38, 0x49, 0x98, 0x2D, 0x70, 0x99, 0x20, 0x45, 0xE8, 
                0x09, 0xA8, 0xCD, 0x50, 0xF9, 0x00, 0x95, 0x38, 0x49, 0xD8, 0x6D, 0xF0, 0x79, 0x80, 0x05, 0x88, 
                0x09, 0x88, 0x0D, 0x90, 0x19, 0xA0, 0x35, 0xB8, 0xC9, 0x58, 0xED, 0x70, 0x99, 0x20, 0x45, 0xE8, 
                0x09, 0xA8, 0xCD, 0x10, 0xB9, 0xC0, 0x15, 0xB8, 0xC9, 0x18, 0xAD, 0xF0, 0x39, 0x40, 0x85, 0xC8, 
                0x09, 0x48, 0x8D, 0xD0, 0x19, 0x20, 0x75, 0xB8, 0xC9, 0x18, 0x2D, 0x70, 0x99, 0xA0, 0xC5, 0xE8, 
                0x09, 0x28, 0x4D, 0x50, 0x79, 0x80, 0x95, 0xB8, 0xC9, 0xD8, 0xED, 0xF0, 0xF9, 0x00, 0x05, 0x08, 
                0x09, 0x08, 0x0D, 0x10, 0x19, 0x20, 0x35, 0x38, 0x49, 0x58, 0x6D, 0x70, 0x99, 0xA0, 0xC5, 0xE8, 
                0x09, 0x28, 0x4D, 0x90, 0xB9, 0xC0, 0x15, 0x38, 0x49, 0x98, 0xAD, 0xF0, 0x39, 0x40, 0x85, 0xC8, 
                0x09, 0x48, 0x8D, 0xD0, 0x19, 0xA0, 0xF5, 0x38, 0x49, 0x98, 0x2D, 0x70, 0x99, 0x20, 0x45, 0xE8, 
                0x09, 0xA8, 0xCD, 0x50, 0xF9, 0x00, 0x95, 0x38, 0x49, 0xD8, 0x6D, 0xF0, 0x79, 0x80, 0x05, 0x88, 
                0x09, 0x88, 0x0D, 0x90, 0x19, 0xA0, 0x35, 0xB8, 0xC9, 0x58, 0xED, 0x70, 0x99, 0x20, 0x45, 0xE8, 
                0x09, 0xA8, 0xCD, 0x10, 0xB9, 0xC0, 0x15, 0xB8, 0xC9, 0x18, 0xAD, 0xF0, 0x39, 0x40, 0x85, 0xC8, 
                0x09, 0x48, 0x8D, 0xD0, 0x19, 0x20, 0x75, 0xB8, 0xC9, 0x18, 0x2D, 0x70, 0x99, 0xA0, 0xC5, 0xE8, 
                0x09, 0x28, 0x4D, 0x50, 0x79, 0x80, 0x95, 0xB8, 0xC9, 0xD8, 0xED, 0xF0, 0xF9, 0x00, 0x05, 0x08, 
            };
            Encryption_Table[0x0A] = new Int16[256] { 
                0x0A, 0x0D, 0x0E, 0x11, 0x1A, 0x2D, 0x36, 0x39, 0x4A, 0x5D, 0x6E, 0x71, 0x9A, 0xBD, 0xC6, 0xE9, 
                0x0A, 0x2D, 0x4E, 0x91, 0xBA, 0xCD, 0x16, 0x39, 0x4A, 0x9D, 0xAE, 0xF1, 0x3A, 0x7D, 0x86, 0xC9, 
                0x0A, 0x4D, 0x8E, 0xD1, 0x1A, 0xAD, 0xF6, 0x39, 0x4A, 0x9D, 0x2E, 0x71, 0x9A, 0x3D, 0x46, 0xE9, 
                0x0A, 0xAD, 0xCE, 0x51, 0xFA, 0x0D, 0x96, 0x39, 0x4A, 0xDD, 0x6E, 0xF1, 0x7A, 0xFD, 0x06, 0x89, 
                0x0A, 0x8D, 0x0E, 0x91, 0x1A, 0xAD, 0x36, 0xB9, 0xCA, 0x5D, 0xEE, 0x71, 0x9A, 0x3D, 0x46, 0xE9, 
                0x0A, 0xAD, 0xCE, 0x11, 0xBA, 0xCD, 0x16, 0xB9, 0xCA, 0x1D, 0xAE, 0xF1, 0x3A, 0x7D, 0x86, 0xC9, 
                0x0A, 0x4D, 0x8E, 0xD1, 0x1A, 0x2D, 0x76, 0xB9, 0xCA, 0x1D, 0x2E, 0x71, 0x9A, 0xBD, 0xC6, 0xE9, 
                0x0A, 0x2D, 0x4E, 0x51, 0x7A, 0x8D, 0x96, 0xB9, 0xCA, 0xDD, 0xEE, 0xF1, 0xFA, 0xFD, 0x06, 0x09, 
                0x0A, 0x0D, 0x0E, 0x11, 0x1A, 0x2D, 0x36, 0x39, 0x4A, 0x5D, 0x6E, 0x71, 0x9A, 0xBD, 0xC6, 0xE9, 
                0x0A, 0x2D, 0x4E, 0x91, 0xBA, 0xCD, 0x16, 0x39, 0x4A, 0x9D, 0xAE, 0xF1, 0x3A, 0x7D, 0x86, 0xC9, 
                0x0A, 0x4D, 0x8E, 0xD1, 0x1A, 0xAD, 0xF6, 0x39, 0x4A, 0x9D, 0x2E, 0x71, 0x9A, 0x3D, 0x46, 0xE9, 
                0x0A, 0xAD, 0xCE, 0x51, 0xFA, 0x0D, 0x96, 0x39, 0x4A, 0xDD, 0x6E, 0xF1, 0x7A, 0xFD, 0x06, 0x89, 
                0x0A, 0x8D, 0x0E, 0x91, 0x1A, 0xAD, 0x36, 0xB9, 0xCA, 0x5D, 0xEE, 0x71, 0x9A, 0x3D, 0x46, 0xE9, 
                0x0A, 0xAD, 0xCE, 0x11, 0xBA, 0xCD, 0x16, 0xB9, 0xCA, 0x1D, 0xAE, 0xF1, 0x3A, 0x7D, 0x86, 0xC9, 
                0x0A, 0x4D, 0x8E, 0xD1, 0x1A, 0x2D, 0x76, 0xB9, 0xCA, 0x1D, 0x2E, 0x71, 0x9A, 0xBD, 0xC6, 0xE9, 
                0x0A, 0x2D, 0x4E, 0x51, 0x7A, 0x8D, 0x96, 0xB9, 0xCA, 0xDD, 0xEE, 0xF1, 0xFA, 0xFD, 0x06, 0x09, 
            };
            Encryption_Table[0x0B] = new Int16[256] { 
                0x0B, 0x0A, 0x0F, 0x12, 0x1B, 0x22, 0x37, 0x3A, 0x4B, 0x5A, 0x6F, 0x72, 0x9B, 0xA2, 0xC7, 0xEA, 
                0x0B, 0x2A, 0x4F, 0x92, 0xBB, 0xC2, 0x17, 0x3A, 0x4B, 0x9A, 0xAF, 0xF2, 0x3B, 0x42, 0x87, 0xCA, 
                0x0B, 0x4A, 0x8F, 0xD2, 0x1B, 0xA2, 0xF7, 0x3A, 0x4B, 0x9A, 0x2F, 0x72, 0x9B, 0x22, 0x47, 0xEA, 
                0x0B, 0xAA, 0xCF, 0x52, 0xFB, 0x02, 0x97, 0x3A, 0x4B, 0xDA, 0x6F, 0xF2, 0x7B, 0x82, 0x07, 0x8A, 
                0x0B, 0x8A, 0x0F, 0x92, 0x1B, 0xA2, 0x37, 0xBA, 0xCB, 0x5A, 0xEF, 0x72, 0x9B, 0x22, 0x47, 0xEA, 
                0x0B, 0xAA, 0xCF, 0x12, 0xBB, 0xC2, 0x17, 0xBA, 0xCB, 0x1A, 0xAF, 0xF2, 0x3B, 0x42, 0x87, 0xCA, 
                0x0B, 0x4A, 0x8F, 0xD2, 0x1B, 0x22, 0x77, 0xBA, 0xCB, 0x1A, 0x2F, 0x72, 0x9B, 0xA2, 0xC7, 0xEA, 
                0x0B, 0x2A, 0x4F, 0x52, 0x7B, 0x82, 0x97, 0xBA, 0xCB, 0xDA, 0xEF, 0xF2, 0xFB, 0x02, 0x07, 0x0A, 
                0x0B, 0x0A, 0x0F, 0x12, 0x1B, 0x22, 0x37, 0x3A, 0x4B, 0x5A, 0x6F, 0x72, 0x9B, 0xA2, 0xC7, 0xEA, 
                0x0B, 0x2A, 0x4F, 0x92, 0xBB, 0xC2, 0x17, 0x3A, 0x4B, 0x9A, 0xAF, 0xF2, 0x3B, 0x42, 0x87, 0xCA, 
                0x0B, 0x4A, 0x8F, 0xD2, 0x1B, 0xA2, 0xF7, 0x3A, 0x4B, 0x9A, 0x2F, 0x72, 0x9B, 0x22, 0x47, 0xEA, 
                0x0B, 0xAA, 0xCF, 0x52, 0xFB, 0x02, 0x97, 0x3A, 0x4B, 0xDA, 0x6F, 0xF2, 0x7B, 0x82, 0x07, 0x8A, 
                0x0B, 0x8A, 0x0F, 0x92, 0x1B, 0xA2, 0x37, 0xBA, 0xCB, 0x5A, 0xEF, 0x72, 0x9B, 0x22, 0x47, 0xEA, 
                0x0B, 0xAA, 0xCF, 0x12, 0xBB, 0xC2, 0x17, 0xBA, 0xCB, 0x1A, 0xAF, 0xF2, 0x3B, 0x42, 0x87, 0xCA, 
                0x0B, 0x4A, 0x8F, 0xD2, 0x1B, 0x22, 0x77, 0xBA, 0xCB, 0x1A, 0x2F, 0x72, 0x9B, 0xA2, 0xC7, 0xEA, 
                0x0B, 0x2A, 0x4F, 0x52, 0x7B, 0x82, 0x97, 0xBA, 0xCB, 0xDA, 0xEF, 0xF2, 0xFB, 0x02, 0x07, 0x0A, 
            };
            Encryption_Table[0x0C] = new Int16[256] { 
                0x0C, 0x0F, 0x10, 0x1B, 0x1C, 0x27, 0x28, 0x3B, 0x4C, 0x5F, 0x60, 0x8B, 0x9C, 0xA7, 0xC8, 0xEB, 
                0x0C, 0x2F, 0x70, 0x9B, 0xBC, 0xC7, 0xE8, 0x3B, 0x4C, 0x9F, 0xA0, 0xEB, 0x3C, 0x47, 0x88, 0xCB, 
                0x0C, 0x4F, 0x90, 0xDB, 0x1C, 0xA7, 0xE8, 0x3B, 0x4C, 0x9F, 0x20, 0x4B, 0x9C, 0x27, 0x48, 0xEB, 
                0x0C, 0xAF, 0x30, 0x5B, 0xFC, 0x07, 0xA8, 0x3B, 0x4C, 0xDF, 0x60, 0xEB, 0x7C, 0x87, 0x08, 0x8B, 
                0x0C, 0x8F, 0x10, 0x9B, 0x1C, 0xA7, 0x28, 0xBB, 0xCC, 0x5F, 0xE0, 0x0B, 0x9C, 0x27, 0x48, 0xEB, 
                0x0C, 0xAF, 0xF0, 0x1B, 0xBC, 0xC7, 0x68, 0xBB, 0xCC, 0x1F, 0xA0, 0xEB, 0x3C, 0x47, 0x88, 0xCB, 
                0x0C, 0x4F, 0x90, 0xDB, 0x1C, 0x27, 0x68, 0xBB, 0xCC, 0x1F, 0x20, 0x4B, 0x9C, 0xA7, 0xC8, 0xEB, 
                0x0C, 0x2F, 0x30, 0x5B, 0x7C, 0x87, 0xA8, 0xBB, 0xCC, 0xDF, 0xE0, 0xEB, 0xFC, 0x07, 0x08, 0x0B, 
                0x0C, 0x0F, 0x10, 0x1B, 0x1C, 0x27, 0x28, 0x3B, 0x4C, 0x5F, 0x60, 0x8B, 0x9C, 0xA7, 0xC8, 0xEB, 
                0x0C, 0x2F, 0x70, 0x9B, 0xBC, 0xC7, 0xE8, 0x3B, 0x4C, 0x9F, 0xA0, 0xEB, 0x3C, 0x47, 0x88, 0xCB, 
                0x0C, 0x4F, 0x90, 0xDB, 0x1C, 0xA7, 0xE8, 0x3B, 0x4C, 0x9F, 0x20, 0x4B, 0x9C, 0x27, 0x48, 0xEB, 
                0x0C, 0xAF, 0x30, 0x5B, 0xFC, 0x07, 0xA8, 0x3B, 0x4C, 0xDF, 0x60, 0xEB, 0x7C, 0x87, 0x08, 0x8B, 
                0x0C, 0x8F, 0x10, 0x9B, 0x1C, 0xA7, 0x28, 0xBB, 0xCC, 0x5F, 0xE0, 0x0B, 0x9C, 0x27, 0x48, 0xEB, 
                0x0C, 0xAF, 0xF0, 0x1B, 0xBC, 0xC7, 0x68, 0xBB, 0xCC, 0x1F, 0xA0, 0xEB, 0x3C, 0x47, 0x88, 0xCB, 
                0x0C, 0x4F, 0x90, 0xDB, 0x1C, 0x27, 0x68, 0xBB, 0xCC, 0x1F, 0x20, 0x4B, 0x9C, 0xA7, 0xC8, 0xEB, 
                0x0C, 0x2F, 0x30, 0x5B, 0x7C, 0x87, 0xA8, 0xBB, 0xCC, 0xDF, 0xE0, 0xEB, 0xFC, 0x07, 0x08, 0x0B, 
            };
            Encryption_Table[0x0D] = new Int16[256] { 
                0x0D, 0x0C, 0x11, 0x14, 0x1D, 0x24, 0x29, 0x3C, 0x4D, 0x5C, 0x61, 0x74, 0x9D, 0xA4, 0xC9, 0xEC, 
                0x0D, 0x2C, 0x71, 0x94, 0xBD, 0xC4, 0xE9, 0x3C, 0x4D, 0x9C, 0xA1, 0xF4, 0x3D, 0x44, 0x89, 0xCC, 
                0x0D, 0x4C, 0x91, 0xD4, 0x1D, 0xA4, 0xE9, 0x3C, 0x4D, 0x9C, 0x21, 0x74, 0x9D, 0x24, 0x49, 0xEC, 
                0x0D, 0xAC, 0x31, 0x54, 0xFD, 0x04, 0xA9, 0x3C, 0x4D, 0xDC, 0x61, 0xF4, 0x7D, 0x84, 0x09, 0x8C, 
                0x0D, 0x8C, 0x11, 0x94, 0x1D, 0xA4, 0x29, 0xBC, 0xCD, 0x5C, 0xE1, 0x74, 0x9D, 0x24, 0x49, 0xEC, 
                0x0D, 0xAC, 0xF1, 0x14, 0xBD, 0xC4, 0x69, 0xBC, 0xCD, 0x1C, 0xA1, 0xF4, 0x3D, 0x44, 0x89, 0xCC, 
                0x0D, 0x4C, 0x91, 0xD4, 0x1D, 0x24, 0x69, 0xBC, 0xCD, 0x1C, 0x21, 0x74, 0x9D, 0xA4, 0xC9, 0xEC, 
                0x0D, 0x2C, 0x31, 0x54, 0x7D, 0x84, 0xA9, 0xBC, 0xCD, 0xDC, 0xE1, 0xF4, 0xFD, 0x04, 0x09, 0x0C, 
                0x0D, 0x0C, 0x11, 0x14, 0x1D, 0x24, 0x29, 0x3C, 0x4D, 0x5C, 0x61, 0x74, 0x9D, 0xA4, 0xC9, 0xEC, 
                0x0D, 0x2C, 0x71, 0x94, 0xBD, 0xC4, 0xE9, 0x3C, 0x4D, 0x9C, 0xA1, 0xF4, 0x3D, 0x44, 0x89, 0xCC, 
                0x0D, 0x4C, 0x91, 0xD4, 0x1D, 0xA4, 0xE9, 0x3C, 0x4D, 0x9C, 0x21, 0x74, 0x9D, 0x24, 0x49, 0xEC, 
                0x0D, 0xAC, 0x31, 0x54, 0xFD, 0x04, 0xA9, 0x3C, 0x4D, 0xDC, 0x61, 0xF4, 0x7D, 0x84, 0x09, 0x8C, 
                0x0D, 0x8C, 0x11, 0x94, 0x1D, 0xA4, 0x29, 0xBC, 0xCD, 0x5C, 0xE1, 0x74, 0x9D, 0x24, 0x49, 0xEC, 
                0x0D, 0xAC, 0xF1, 0x14, 0xBD, 0xC4, 0x69, 0xBC, 0xCD, 0x1C, 0xA1, 0xF4, 0x3D, 0x44, 0x89, 0xCC, 
                0x0D, 0x4C, 0x91, 0xD4, 0x1D, 0x24, 0x69, 0xBC, 0xCD, 0x1C, 0x21, 0x74, 0x9D, 0xA4, 0xC9, 0xEC, 
                0x0D, 0x2C, 0x31, 0x54, 0x7D, 0x84, 0xA9, 0xBC, 0xCD, 0xDC, 0xE1, 0xF4, 0xFD, 0x04, 0x09, 0x0C, 
            };
            Encryption_Table[0x0E] = new Int16[256] { 
                0x0E, 0x11, 0x12, 0x15, 0x1E, 0x21, 0x2A, 0x3D, 0x4E, 0x51, 0x62, 0x75, 0x9E, 0xA1, 0xCA, 0xED, 
                0x0E, 0x51, 0x72, 0x95, 0xBE, 0xC1, 0xEA, 0x3D, 0x4E, 0x91, 0xA2, 0xF5, 0x3E, 0x41, 0x8A, 0xCD, 
                0x0E, 0x51, 0x92, 0xD5, 0x1E, 0xA1, 0xEA, 0x3D, 0x4E, 0x91, 0x22, 0x75, 0x9E, 0x21, 0x4A, 0xED, 
                0x0E, 0x91, 0x32, 0x55, 0xFE, 0x01, 0xAA, 0x3D, 0x4E, 0xD1, 0x62, 0xF5, 0x7E, 0x81, 0x0A, 0x8D, 
                0x0E, 0x91, 0x12, 0x95, 0x1E, 0xA1, 0x2A, 0xBD, 0xCE, 0x51, 0xE2, 0x75, 0x9E, 0x21, 0x4A, 0xED, 
                0x0E, 0x51, 0xF2, 0x15, 0xBE, 0xC1, 0x6A, 0xBD, 0xCE, 0x11, 0xA2, 0xF5, 0x3E, 0x41, 0x8A, 0xCD, 
                0x0E, 0x51, 0x92, 0xD5, 0x1E, 0x21, 0x6A, 0xBD, 0xCE, 0x11, 0x22, 0x75, 0x9E, 0xA1, 0xCA, 0xED, 
                0x0E, 0x11, 0x32, 0x55, 0x7E, 0x81, 0xAA, 0xBD, 0xCE, 0xD1, 0xE2, 0xF5, 0xFE, 0x01, 0x0A, 0x0D, 
                0x0E, 0x11, 0x12, 0x15, 0x1E, 0x21, 0x2A, 0x3D, 0x4E, 0x51, 0x62, 0x75, 0x9E, 0xA1, 0xCA, 0xED, 
                0x0E, 0x51, 0x72, 0x95, 0xBE, 0xC1, 0xEA, 0x3D, 0x4E, 0x91, 0xA2, 0xF5, 0x3E, 0x41, 0x8A, 0xCD, 
                0x0E, 0x51, 0x92, 0xD5, 0x1E, 0xA1, 0xEA, 0x3D, 0x4E, 0x91, 0x22, 0x75, 0x9E, 0x21, 0x4A, 0xED, 
                0x0E, 0x91, 0x32, 0x55, 0xFE, 0x01, 0xAA, 0x3D, 0x4E, 0xD1, 0x62, 0xF5, 0x7E, 0x81, 0x0A, 0x8D, 
                0x0E, 0x91, 0x12, 0x95, 0x1E, 0xA1, 0x2A, 0xBD, 0xCE, 0x51, 0xE2, 0x75, 0x9E, 0x21, 0x4A, 0xED, 
                0x0E, 0x51, 0xF2, 0x15, 0xBE, 0xC1, 0x6A, 0xBD, 0xCE, 0x11, 0xA2, 0xF5, 0x3E, 0x41, 0x8A, 0xCD, 
                0x0E, 0x51, 0x92, 0xD5, 0x1E, 0x21, 0x6A, 0xBD, 0xCE, 0x11, 0x22, 0x75, 0x9E, 0xA1, 0xCA, 0xED, 
                0x0E, 0x11, 0x32, 0x55, 0x7E, 0x81, 0xAA, 0xBD, 0xCE, 0xD1, 0xE2, 0xF5, 0xFE, 0x01, 0x0A, 0x0D, 
            };

            Encryption_Table[0x30] = new Int16[256] { 
                0x30, 0x33, 0x34, 0x3F, 0x40, 0x4B, 0x5C, 0x6F, 0x70, 0x83, 0x94, 0xBF, 0xC0, 0xEB, 0x0C, 0x2F, 
                0x30, 0x53, 0x74, 0x9F, 0xA0, 0xCB, 0x1C, 0x2F, 0x70, 0x83, 0xD4, 0x1F, 0x20, 0x6B, 0xAC, 0xEF, 
                0x30, 0x73, 0xB4, 0xFF, 0x00, 0x4B, 0x9C, 0x2F, 0x70, 0x83, 0xD4, 0x7F, 0x80, 0x2B, 0x4C, 0xEF, 
                0x30, 0x53, 0xF4, 0x1F, 0xA0, 0xCB, 0x5C, 0xEF, 0x70, 0x83, 0x14, 0x9F, 0x20, 0xAB, 0x2C, 0xAF, 
                0x30, 0xB3, 0x34, 0xBF, 0xC0, 0x4B, 0xDC, 0x6F, 0xF0, 0x03, 0x94, 0x3F, 0x40, 0xEB, 0x0C, 0xAF, 
                0x30, 0x53, 0xF4, 0x1F, 0xA0, 0xCB, 0x1C, 0xAF, 0xF0, 0x03, 0x54, 0x9F, 0x20, 0x6B, 0xAC, 0xEF, 
                0x30, 0x73, 0xB4, 0xFF, 0x00, 0x4B, 0x9C, 0xAF, 0xF0, 0x03, 0x54, 0x7F, 0x80, 0xAB, 0xCC, 0xEF, 
                0x30, 0x53, 0x74, 0x9F, 0xA0, 0xCB, 0xDC, 0xEF, 0xF0, 0x03, 0x14, 0x1F, 0x20, 0x2B, 0x2C, 0x2F, 
                0x30, 0x33, 0x34, 0x3F, 0x40, 0x4B, 0x5C, 0x6F, 0x70, 0x83, 0x94, 0xBF, 0xC0, 0xEB, 0x0C, 0x2F, 
                0x30, 0x53, 0x74, 0x9F, 0xA0, 0xCB, 0x1C, 0x2F, 0x70, 0x83, 0xD4, 0x1F, 0x20, 0x6B, 0xAC, 0xEF, 
                0x30, 0x73, 0xB4, 0xFF, 0x00, 0x4B, 0x9C, 0x2F, 0x70, 0x83, 0xD4, 0x7F, 0x80, 0x2B, 0x4C, 0xEF, 
                0x30, 0x53, 0xF4, 0x1F, 0xA0, 0xCB, 0x5C, 0xEF, 0x70, 0x83, 0x14, 0x9F, 0x20, 0xAB, 0x2C, 0xAF, 
                0x30, 0xB3, 0x34, 0xBF, 0xC0, 0x4B, 0xDC, 0x6F, 0xF0, 0x03, 0x94, 0x3F, 0x40, 0xEB, 0x0C, 0xAF, 
                0x30, 0x53, 0xF4, 0x1F, 0xA0, 0xCB, 0x1C, 0xAF, 0xF0, 0x03, 0x54, 0x9F, 0x20, 0x6B, 0xAC, 0xEF, 
                0x30, 0x73, 0xB4, 0xFF, 0x00, 0x4B, 0x9C, 0xAF, 0xF0, 0x03, 0x54, 0x7F, 0x80, 0xAB, 0xCC, 0xEF, 
                0x30, 0x53, 0x74, 0x9F, 0xA0, 0xCB, 0xDC, 0xEF, 0xF0, 0x03, 0x14, 0x1F, 0x20, 0x2B, 0x2C, 0x2F, 
            };
            Encryption_Table[0x33] = new Int16[256] { 
                0x33, 0x32, 0x37, 0x3A, 0x43, 0x4A, 0x5F, 0x62, 0x73, 0x82, 0x97, 0xBA, 0xC3, 0xEA, 0x0F, 0x12, 
                0x33, 0x52, 0x77, 0x9A, 0xA3, 0xCA, 0x1F, 0x22, 0x73, 0x82, 0xD7, 0x1A, 0x23, 0x6A, 0xAF, 0xF2, 
                0x33, 0x72, 0xB7, 0xFA, 0x03, 0x4A, 0x9F, 0x22, 0x73, 0x82, 0xD7, 0x7A, 0x83, 0x2A, 0x4F, 0x92, 
                0x33, 0x52, 0xF7, 0x1A, 0xA3, 0xCA, 0x5F, 0xE2, 0x73, 0x82, 0x17, 0x9A, 0x23, 0xAA, 0x2F, 0xB2, 
                0x33, 0xB2, 0x37, 0xBA, 0xC3, 0x4A, 0xDF, 0x62, 0xF3, 0x02, 0x97, 0x3A, 0x43, 0xEA, 0x0F, 0x92, 
                0x33, 0x52, 0xF7, 0x1A, 0xA3, 0xCA, 0x1F, 0xA2, 0xF3, 0x02, 0x57, 0x9A, 0x23, 0x6A, 0xAF, 0xF2, 
                0x33, 0x72, 0xB7, 0xFA, 0x03, 0x4A, 0x9F, 0xA2, 0xF3, 0x02, 0x57, 0x7A, 0x83, 0xAA, 0xCF, 0x12, 
                0x33, 0x52, 0x77, 0x9A, 0xA3, 0xCA, 0xDF, 0xE2, 0xF3, 0x02, 0x17, 0x1A, 0x23, 0x2A, 0x2F, 0x32, 
                0x33, 0x32, 0x37, 0x3A, 0x43, 0x4A, 0x5F, 0x62, 0x73, 0x82, 0x97, 0xBA, 0xC3, 0xEA, 0x0F, 0x12, 
                0x33, 0x52, 0x77, 0x9A, 0xA3, 0xCA, 0x1F, 0x22, 0x73, 0x82, 0xD7, 0x1A, 0x23, 0x6A, 0xAF, 0xF2, 
                0x33, 0x72, 0xB7, 0xFA, 0x03, 0x4A, 0x9F, 0x22, 0x73, 0x82, 0xD7, 0x7A, 0x83, 0x2A, 0x4F, 0x92, 
                0x33, 0x52, 0xF7, 0x1A, 0xA3, 0xCA, 0x5F, 0xE2, 0x73, 0x82, 0x17, 0x9A, 0x23, 0xAA, 0x2F, 0xB2, 
                0x33, 0xB2, 0x37, 0xBA, 0xC3, 0x4A, 0xDF, 0x62, 0xF3, 0x02, 0x97, 0x3A, 0x43, 0xEA, 0x0F, 0x92, 
                0x33, 0x52, 0xF7, 0x1A, 0xA3, 0xCA, 0x1F, 0xA2, 0xF3, 0x02, 0x57, 0x9A, 0x23, 0x6A, 0xAF, 0xF2, 
                0x33, 0x72, 0xB7, 0xFA, 0x03, 0x4A, 0x9F, 0xA2, 0xF3, 0x02, 0x57, 0x7A, 0x83, 0xAA, 0xCF, 0x12, 
                0x33, 0x52, 0x77, 0x9A, 0xA3, 0xCA, 0xDF, 0xE2, 0xF3, 0x02, 0x17, 0x1A, 0x23, 0x2A, 0x2F, 0x32, 
            };
            Encryption_Table[0x34] = new Int16[256] { 
                0x34, 0x37, 0x38, 0x43, 0x44, 0x4F, 0x50, 0x63, 0x74, 0x87, 0xA8, 0xB3, 0xC4, 0xEF, 0xF0, 0x13, 
                0x34, 0x57, 0x78, 0x83, 0xA4, 0xCF, 0x10, 0x23, 0x74, 0x87, 0xC8, 0x13, 0x24, 0x6F, 0xB0, 0xF3, 
                0x34, 0x77, 0xB8, 0xC3, 0x04, 0x4F, 0x90, 0x23, 0x74, 0x87, 0x28, 0x73, 0x84, 0x2F, 0x70, 0x93, 
                0x34, 0x57, 0xF8, 0x03, 0xA4, 0xCF, 0x50, 0xE3, 0x74, 0x87, 0x08, 0x93, 0x24, 0xAF, 0x30, 0xB3, 
                0x34, 0xB7, 0x38, 0x43, 0xC4, 0x4F, 0xD0, 0x63, 0xF4, 0x07, 0xA8, 0x33, 0x44, 0xEF, 0x70, 0x93, 
                0x34, 0x57, 0xF8, 0x03, 0xA4, 0xCF, 0x10, 0xA3, 0xF4, 0x07, 0x48, 0x93, 0x24, 0x6F, 0xB0, 0xF3, 
                0x34, 0x77, 0xB8, 0xC3, 0x04, 0x4F, 0x90, 0xA3, 0xF4, 0x07, 0x28, 0x73, 0x84, 0xAF, 0xF0, 0x13, 
                0x34, 0x57, 0x78, 0x83, 0xA4, 0xCF, 0xD0, 0xE3, 0xF4, 0x07, 0x08, 0x13, 0x24, 0x2F, 0x30, 0x33, 
                0x34, 0x37, 0x38, 0x43, 0x44, 0x4F, 0x50, 0x63, 0x74, 0x87, 0xA8, 0xB3, 0xC4, 0xEF, 0xF0, 0x13, 
                0x34, 0x57, 0x78, 0x83, 0xA4, 0xCF, 0x10, 0x23, 0x74, 0x87, 0xC8, 0x13, 0x24, 0x6F, 0xB0, 0xF3, 
                0x34, 0x77, 0xB8, 0xC3, 0x04, 0x4F, 0x90, 0x23, 0x74, 0x87, 0x28, 0x73, 0x84, 0x2F, 0x70, 0x93, 
                0x34, 0x57, 0xF8, 0x03, 0xA4, 0xCF, 0x50, 0xE3, 0x74, 0x87, 0x08, 0x93, 0x24, 0xAF, 0x30, 0xB3, 
                0x34, 0xB7, 0x38, 0x43, 0xC4, 0x4F, 0xD0, 0x63, 0xF4, 0x07, 0xA8, 0x33, 0x44, 0xEF, 0x70, 0x93, 
                0x34, 0x57, 0xF8, 0x03, 0xA4, 0xCF, 0x10, 0xA3, 0xF4, 0x07, 0x48, 0x93, 0x24, 0x6F, 0xB0, 0xF3, 
                0x34, 0x77, 0xB8, 0xC3, 0x04, 0x4F, 0x90, 0xA3, 0xF4, 0x07, 0x28, 0x73, 0x84, 0xAF, 0xF0, 0x13, 
                0x34, 0x57, 0x78, 0x83, 0xA4, 0xCF, 0xD0, 0xE3, 0xF4, 0x07, 0x08, 0x13, 0x24, 0x2F, 0x30, 0x33, 
            };
            Encryption_Table[0x38] = new Int16[256] { 
                0x38, 0x3B, 0x3C, 0x47, 0x48, 0x53, 0x64, 0x77, 0x78, 0x8B, 0x9C, 0xA7, 0xC8, 0xD3, 0xF4, 0x17, 
                0x38, 0x5B, 0x7C, 0x87, 0xA8, 0xF3, 0x04, 0x57, 0x78, 0x8B, 0xDC, 0xE7, 0x28, 0x73, 0xB4, 0xF7, 
                0x38, 0x7B, 0xBC, 0xC7, 0x08, 0x53, 0xE4, 0x37, 0x78, 0x8B, 0xDC, 0x67, 0x88, 0xD3, 0x74, 0x97, 
                0x38, 0x5B, 0xFC, 0x07, 0xA8, 0x33, 0x44, 0xD7, 0x78, 0x8B, 0x1C, 0xA7, 0x28, 0xB3, 0x34, 0xB7, 
                0x38, 0xBB, 0x3C, 0x47, 0xC8, 0x53, 0xE4, 0x77, 0xF8, 0x0B, 0x9C, 0x27, 0x48, 0xD3, 0x74, 0x97, 
                0x38, 0x5B, 0xFC, 0x07, 0xA8, 0xF3, 0x04, 0x57, 0xF8, 0x0B, 0x5C, 0xE7, 0x28, 0x73, 0xB4, 0xF7, 
                0x38, 0x7B, 0xBC, 0xC7, 0x08, 0x53, 0x64, 0xB7, 0xF8, 0x0B, 0x5C, 0x67, 0x88, 0xD3, 0xF4, 0x17, 
                0x38, 0x5B, 0x7C, 0x87, 0xA8, 0xB3, 0xC4, 0xD7, 0xF8, 0x0B, 0x1C, 0x27, 0x28, 0x33, 0x34, 0x37, 
                0x38, 0x3B, 0x3C, 0x47, 0x48, 0x53, 0x64, 0x77, 0x78, 0x8B, 0x9C, 0xA7, 0xC8, 0xD3, 0xF4, 0x17, 
                0x38, 0x5B, 0x7C, 0x87, 0xA8, 0xF3, 0x04, 0x57, 0x78, 0x8B, 0xDC, 0xE7, 0x28, 0x73, 0xB4, 0xF7, 
                0x38, 0x7B, 0xBC, 0xC7, 0x08, 0x53, 0xE4, 0x37, 0x78, 0x8B, 0xDC, 0x67, 0x88, 0xD3, 0x74, 0x97, 
                0x38, 0x5B, 0xFC, 0x07, 0xA8, 0x33, 0x44, 0xD7, 0x78, 0x8B, 0x1C, 0xA7, 0x28, 0xB3, 0x34, 0xB7, 
                0x38, 0xBB, 0x3C, 0x47, 0xC8, 0x53, 0xE4, 0x77, 0xF8, 0x0B, 0x9C, 0x27, 0x48, 0xD3, 0x74, 0x97, 
                0x38, 0x5B, 0xFC, 0x07, 0xA8, 0xF3, 0x04, 0x57, 0xF8, 0x0B, 0x5C, 0xE7, 0x28, 0x73, 0xB4, 0xF7, 
                0x38, 0x7B, 0xBC, 0xC7, 0x08, 0x53, 0x64, 0xB7, 0xF8, 0x0B, 0x5C, 0x67, 0x88, 0xD3, 0xF4, 0x17, 
                0x38, 0x5B, 0x7C, 0x87, 0xA8, 0xB3, 0xC4, 0xD7, 0xF8, 0x0B, 0x1C, 0x27, 0x28, 0x33, 0x34, 0x37, 
            };
            Encryption_Table[0x41] = new Int16[256] { 
                0x41, 0x40, 0x45, 0x48, 0x51, 0x58, 0x6D, 0x70, 0x81, 0x90, 0xA5, 0xC8, 0xD1, 0xF8, 0x1D, 0x20, 
                0x41, 0x60, 0x85, 0xA8, 0xF1, 0x18, 0x2D, 0x70, 0x81, 0xD0, 0xE5, 0x28, 0x71, 0xB8, 0xFD, 0x00, 
                0x41, 0x80, 0xC5, 0x08, 0x51, 0x98, 0x2D, 0x70, 0x81, 0xD0, 0x65, 0x88, 0xD1, 0x78, 0x9D, 0x20, 
                0x41, 0xE0, 0x05, 0xA8, 0x31, 0x58, 0xED, 0x70, 0x81, 0x10, 0xA5, 0x28, 0xB1, 0x38, 0xBD, 0xC0, 
                0x41, 0xC0, 0x45, 0xC8, 0x51, 0xD8, 0x6D, 0xF0, 0x01, 0x90, 0x25, 0x48, 0xD1, 0x78, 0x9D, 0x20, 
                0x41, 0xE0, 0x05, 0xA8, 0xF1, 0x18, 0xAD, 0xF0, 0x01, 0x50, 0xE5, 0x28, 0x71, 0xB8, 0xFD, 0x00, 
                0x41, 0x80, 0xC5, 0x08, 0x51, 0x98, 0xAD, 0xF0, 0x01, 0x50, 0x65, 0x88, 0xD1, 0xF8, 0x1D, 0x20, 
                0x41, 0x60, 0x85, 0xA8, 0xB1, 0xD8, 0xED, 0xF0, 0x01, 0x10, 0x25, 0x28, 0x31, 0x38, 0x3D, 0x40, 
                0x41, 0x40, 0x45, 0x48, 0x51, 0x58, 0x6D, 0x70, 0x81, 0x90, 0xA5, 0xC8, 0xD1, 0xF8, 0x1D, 0x20, 
                0x41, 0x60, 0x85, 0xA8, 0xF1, 0x18, 0x2D, 0x70, 0x81, 0xD0, 0xE5, 0x28, 0x71, 0xB8, 0xFD, 0x00, 
                0x41, 0x80, 0xC5, 0x08, 0x51, 0x98, 0x2D, 0x70, 0x81, 0xD0, 0x65, 0x88, 0xD1, 0x78, 0x9D, 0x20, 
                0x41, 0xE0, 0x05, 0xA8, 0x31, 0x58, 0xED, 0x70, 0x81, 0x10, 0xA5, 0x28, 0xB1, 0x38, 0xBD, 0xC0, 
                0x41, 0xC0, 0x45, 0xC8, 0x51, 0xD8, 0x6D, 0xF0, 0x01, 0x90, 0x25, 0x48, 0xD1, 0x78, 0x9D, 0x20, 
                0x41, 0xE0, 0x05, 0xA8, 0xF1, 0x18, 0xAD, 0xF0, 0x01, 0x50, 0xE5, 0x28, 0x71, 0xB8, 0xFD, 0x00, 
                0x41, 0x80, 0xC5, 0x08, 0x51, 0x98, 0xAD, 0xF0, 0x01, 0x50, 0x65, 0x88, 0xD1, 0xF8, 0x1D, 0x20, 
                0x41, 0x60, 0x85, 0xA8, 0xB1, 0xD8, 0xED, 0xF0, 0x01, 0x10, 0x25, 0x28, 0x31, 0x38, 0x3D, 0x40, 
            };
            Encryption_Table[0x58] = new Int16[256] { 
                0x58, 0x5B, 0x5C, 0x67, 0x68, 0x73, 0x84, 0x97, 0x98, 0xAB, 0xBC, 0xC7, 0xE8, 0xF3, 0x14, 0x37, 
                0x58, 0x7B, 0x9C, 0xA7, 0xC8, 0x13, 0x24, 0x77, 0x98, 0xAB, 0xFC, 0x07, 0x48, 0x93, 0xD4, 0x17, 
                0x58, 0x9B, 0xDC, 0x67, 0xA8, 0xF3, 0x04, 0x57, 0x98, 0x2B, 0x7C, 0x87, 0x28, 0x73, 0x94, 0x37, 
                0x58, 0xFB, 0x1C, 0xA7, 0xC8, 0x53, 0xE4, 0x77, 0x98, 0x2B, 0xBC, 0xC7, 0x48, 0xD3, 0x54, 0xD7, 
                0x58, 0xDB, 0x5C, 0xE7, 0x68, 0xF3, 0x04, 0x97, 0x18, 0xAB, 0x3C, 0x47, 0xE8, 0x73, 0x94, 0x37, 
                0x58, 0xFB, 0x1C, 0xA7, 0xC8, 0x13, 0xA4, 0xF7, 0x18, 0xAB, 0xFC, 0x07, 0x48, 0x93, 0xD4, 0x17, 
                0x58, 0x9B, 0xDC, 0xE7, 0x28, 0x73, 0x84, 0xD7, 0x18, 0x2B, 0x7C, 0x87, 0xA8, 0xF3, 0x14, 0x37, 
                0x58, 0x7B, 0x9C, 0xA7, 0xC8, 0xD3, 0xE4, 0xF7, 0x18, 0x2B, 0x3C, 0x47, 0x48, 0x53, 0x54, 0x57, 
                0x58, 0x5B, 0x5C, 0x67, 0x68, 0x73, 0x84, 0x97, 0x98, 0xAB, 0xBC, 0xC7, 0xE8, 0xF3, 0x14, 0x37, 
                0x58, 0x7B, 0x9C, 0xA7, 0xC8, 0x13, 0x24, 0x77, 0x98, 0xAB, 0xFC, 0x07, 0x48, 0x93, 0xD4, 0x17, 
                0x58, 0x9B, 0xDC, 0x67, 0xA8, 0xF3, 0x04, 0x57, 0x98, 0x2B, 0x7C, 0x87, 0x28, 0x73, 0x94, 0x37, 
                0x58, 0xFB, 0x1C, 0xA7, 0xC8, 0x53, 0xE4, 0x77, 0x98, 0x2B, 0xBC, 0xC7, 0x48, 0xD3, 0x54, 0xD7, 
                0x58, 0xDB, 0x5C, 0xE7, 0x68, 0xF3, 0x04, 0x97, 0x18, 0xAB, 0x3C, 0x47, 0xE8, 0x73, 0x94, 0x37, 
                0x58, 0xFB, 0x1C, 0xA7, 0xC8, 0x13, 0xA4, 0xF7, 0x18, 0xAB, 0xFC, 0x07, 0x48, 0x93, 0xD4, 0x17, 
                0x58, 0x9B, 0xDC, 0xE7, 0x28, 0x73, 0x84, 0xD7, 0x18, 0x2B, 0x7C, 0x87, 0xA8, 0xF3, 0x14, 0x37, 
                0x58, 0x7B, 0x9C, 0xA7, 0xC8, 0xD3, 0xE4, 0xF7, 0x18, 0x2B, 0x3C, 0x47, 0x48, 0x53, 0x54, 0x57, 
            };
            Encryption_Table[0x5A] = new Int16[256] { 
                0x5A, 0x5D, 0x5E, 0x61, 0x6A, 0x7D, 0x86, 0x89, 0x9A, 0xAD, 0xBE, 0xC1, 0xEA, 0x0D, 0x16, 0x39, 
                0x5A, 0x7D, 0x9E, 0xA1, 0xCA, 0x1D, 0x26, 0x49, 0x9A, 0xAD, 0xFE, 0x01, 0x4A, 0x8D, 0xD6, 0x19, 
                0x5A, 0x9D, 0xDE, 0x61, 0xAA, 0xFD, 0x06, 0x49, 0x9A, 0x2D, 0x7E, 0x81, 0x2A, 0x4D, 0x96, 0x39, 
                0x5A, 0xFD, 0x1E, 0xA1, 0xCA, 0x5D, 0xE6, 0x09, 0x9A, 0x2D, 0xBE, 0xC1, 0x4A, 0xCD, 0x56, 0xD9, 
                0x5A, 0xDD, 0x5E, 0xE1, 0x6A, 0xFD, 0x06, 0x89, 0x1A, 0xAD, 0x3E, 0x41, 0xEA, 0x0D, 0x96, 0x39, 
                0x5A, 0xFD, 0x1E, 0xA1, 0xCA, 0x1D, 0xA6, 0xC9, 0x1A, 0xAD, 0xFE, 0x01, 0x4A, 0x8D, 0xD6, 0x19, 
                0x5A, 0x9D, 0xDE, 0xE1, 0x2A, 0x7D, 0x86, 0xC9, 0x1A, 0x2D, 0x7E, 0x81, 0xAA, 0xCD, 0x16, 0x39, 
                0x5A, 0x7D, 0x9E, 0xA1, 0xCA, 0xDD, 0xE6, 0x09, 0x1A, 0x2D, 0x3E, 0x41, 0x4A, 0x4D, 0x56, 0x59, 
                0x5A, 0x5D, 0x5E, 0x61, 0x6A, 0x7D, 0x86, 0x89, 0x9A, 0xAD, 0xBE, 0xC1, 0xEA, 0x0D, 0x16, 0x39, 
                0x5A, 0x7D, 0x9E, 0xA1, 0xCA, 0x1D, 0x26, 0x49, 0x9A, 0xAD, 0xFE, 0x01, 0x4A, 0x8D, 0xD6, 0x19, 
                0x5A, 0x9D, 0xDE, 0x61, 0xAA, 0xFD, 0x06, 0x49, 0x9A, 0x2D, 0x7E, 0x81, 0x2A, 0x4D, 0x96, 0x39, 
                0x5A, 0xFD, 0x1E, 0xA1, 0xCA, 0x5D, 0xE6, 0x09, 0x9A, 0x2D, 0xBE, 0xC1, 0x4A, 0xCD, 0x56, 0xD9, 
                0x5A, 0xDD, 0x5E, 0xE1, 0x6A, 0xFD, 0x06, 0x89, 0x1A, 0xAD, 0x3E, 0x41, 0xEA, 0x0D, 0x96, 0x39, 
                0x5A, 0xFD, 0x1E, 0xA1, 0xCA, 0x1D, 0xA6, 0xC9, 0x1A, 0xAD, 0xFE, 0x01, 0x4A, 0x8D, 0xD6, 0x19, 
                0x5A, 0x9D, 0xDE, 0xE1, 0x2A, 0x7D, 0x86, 0xC9, 0x1A, 0x2D, 0x7E, 0x81, 0xAA, 0xCD, 0x16, 0x39, 
                0x5A, 0x7D, 0x9E, 0xA1, 0xCA, 0xDD, 0xE6, 0x09, 0x1A, 0x2D, 0x3E, 0x41, 0x4A, 0x4D, 0x56, 0x59, 
            };
            Encryption_Table[0x62] = new Int16[256] { 
                0x62, 0x65, 0x66, 0x69, 0x72, 0x85, 0x8E, 0x91, 0xA2, 0xB5, 0xC6, 0xE9, 0xF2, 0x15, 0x3E, 0x41, 
                0x62, 0x85, 0xA6, 0xC9, 0x12, 0x25, 0x4E, 0x91, 0xA2, 0xF5, 0x06, 0x49, 0x92, 0xD5, 0x1E, 0x21, 
                0x62, 0xA5, 0xE6, 0x29, 0x72, 0x85, 0xCE, 0x11, 0xA2, 0xF5, 0x06, 0xA9, 0xF2, 0x15, 0xBE, 0xC1, 
                0x62, 0x85, 0x26, 0x49, 0xD2, 0x65, 0x8E, 0x11, 0xA2, 0x35, 0x46, 0xC9, 0x52, 0xD5, 0x5E, 0xE1, 
                0x62, 0xE5, 0x66, 0xE9, 0x72, 0x85, 0x0E, 0x91, 0x22, 0xB5, 0xC6, 0x69, 0xF2, 0x15, 0xBE, 0xC1, 
                0x62, 0x85, 0x26, 0x49, 0x92, 0x25, 0x4E, 0x91, 0x22, 0x75, 0x86, 0xC9, 0x12, 0x55, 0x9E, 0x21, 
                0x62, 0xA5, 0xE6, 0x29, 0x72, 0x85, 0xCE, 0x11, 0x22, 0x75, 0x86, 0xA9, 0xF2, 0x15, 0x3E, 0x41, 
                0x62, 0x85, 0xA6, 0xC9, 0xD2, 0xE5, 0x0E, 0x11, 0x22, 0x35, 0x46, 0x49, 0x52, 0x55, 0x5E, 0x61, 
                0x62, 0x65, 0x66, 0x69, 0x72, 0x85, 0x8E, 0x91, 0xA2, 0xB5, 0xC6, 0xE9, 0xF2, 0x15, 0x3E, 0x41, 
                0x62, 0x85, 0xA6, 0xC9, 0x12, 0x25, 0x4E, 0x91, 0xA2, 0xF5, 0x06, 0x49, 0x92, 0xD5, 0x1E, 0x21, 
                0x62, 0xA5, 0xE6, 0x29, 0x72, 0x85, 0xCE, 0x11, 0xA2, 0xF5, 0x06, 0xA9, 0xF2, 0x15, 0xBE, 0xC1, 
                0x62, 0x85, 0x26, 0x49, 0xD2, 0x65, 0x8E, 0x11, 0xA2, 0x35, 0x46, 0xC9, 0x52, 0xD5, 0x5E, 0xE1, 
                0x62, 0xE5, 0x66, 0xE9, 0x72, 0x85, 0x0E, 0x91, 0x22, 0xB5, 0xC6, 0x69, 0xF2, 0x15, 0xBE, 0xC1, 
                0x62, 0x85, 0x26, 0x49, 0x92, 0x25, 0x4E, 0x91, 0x22, 0x75, 0x86, 0xC9, 0x12, 0x55, 0x9E, 0x21, 
                0x62, 0xA5, 0xE6, 0x29, 0x72, 0x85, 0xCE, 0x11, 0x22, 0x75, 0x86, 0xA9, 0xF2, 0x15, 0x3E, 0x41, 
                0x62, 0x85, 0xA6, 0xC9, 0xD2, 0xE5, 0x0E, 0x11, 0x22, 0x35, 0x46, 0x49, 0x52, 0x55, 0x5E, 0x61, 
            };
            Encryption_Table[0x68] = new Int16[256] { 
                0x68, 0x6B, 0x6C, 0x77, 0x78, 0x83, 0x94, 0xA7, 0xA8, 0xBB, 0xCC, 0xD7, 0xF8, 0x03, 0x24, 0x47, 
                0x68, 0x8B, 0xAC, 0xF7, 0x18, 0x23, 0x74, 0x87, 0xA8, 0xFB, 0x0C, 0x57, 0x98, 0xA3, 0xE4, 0x27, 
                0x68, 0xAB, 0xEC, 0x37, 0x78, 0x83, 0xD4, 0x67, 0xA8, 0xFB, 0x0C, 0x57, 0xF8, 0x03, 0xA4, 0xC7, 
                0x68, 0x8B, 0x2C, 0xB7, 0xD8, 0x63, 0xF4, 0x07, 0xA8, 0x3B, 0x4C, 0xD7, 0x58, 0xE3, 0x64, 0xE7, 
                0x68, 0xEB, 0x6C, 0xF7, 0x78, 0x83, 0x14, 0xA7, 0x28, 0xBB, 0xCC, 0x57, 0xF8, 0x03, 0xA4, 0xC7, 
                0x68, 0x8B, 0x2C, 0x77, 0x98, 0x23, 0x74, 0x87, 0x28, 0x7B, 0x8C, 0xD7, 0x18, 0xA3, 0xE4, 0x27, 
                0x68, 0xAB, 0xEC, 0x37, 0x78, 0x83, 0xD4, 0xE7, 0x28, 0x7B, 0x8C, 0xD7, 0xF8, 0x03, 0x24, 0x47, 
                0x68, 0x8B, 0xAC, 0xB7, 0xD8, 0xE3, 0xF4, 0x07, 0x28, 0x3B, 0x4C, 0x57, 0x58, 0x63, 0x64, 0x67, 
                0x68, 0x6B, 0x6C, 0x77, 0x78, 0x83, 0x94, 0xA7, 0xA8, 0xBB, 0xCC, 0xD7, 0xF8, 0x03, 0x24, 0x47, 
                0x68, 0x8B, 0xAC, 0xF7, 0x18, 0x23, 0x74, 0x87, 0xA8, 0xFB, 0x0C, 0x57, 0x98, 0xA3, 0xE4, 0x27, 
                0x68, 0xAB, 0xEC, 0x37, 0x78, 0x83, 0xD4, 0x67, 0xA8, 0xFB, 0x0C, 0x57, 0xF8, 0x03, 0xA4, 0xC7, 
                0x68, 0x8B, 0x2C, 0xB7, 0xD8, 0x63, 0xF4, 0x07, 0xA8, 0x3B, 0x4C, 0xD7, 0x58, 0xE3, 0x64, 0xE7, 
                0x68, 0xEB, 0x6C, 0xF7, 0x78, 0x83, 0x14, 0xA7, 0x28, 0xBB, 0xCC, 0x57, 0xF8, 0x03, 0xA4, 0xC7, 
                0x68, 0x8B, 0x2C, 0x77, 0x98, 0x23, 0x74, 0x87, 0x28, 0x7B, 0x8C, 0xD7, 0x18, 0xA3, 0xE4, 0x27, 
                0x68, 0xAB, 0xEC, 0x37, 0x78, 0x83, 0xD4, 0xE7, 0x28, 0x7B, 0x8C, 0xD7, 0xF8, 0x03, 0x24, 0x47, 
                0x68, 0x8B, 0xAC, 0xB7, 0xD8, 0xE3, 0xF4, 0x07, 0x28, 0x3B, 0x4C, 0x57, 0x58, 0x63, 0x64, 0x67, 
            };
            Encryption_Table[0x6A] = new Int16[256] { 
                0x6A, 0x6D, 0x6E, 0x71, 0x7A, 0x8D, 0x96, 0x99, 0xAA, 0xBD, 0xCE, 0xD1, 0xFA, 0x1D, 0x26, 0x49, 
                0x6A, 0x8D, 0xAE, 0xF1, 0x1A, 0x2D, 0x76, 0x99, 0xAA, 0xFD, 0x0E, 0x51, 0x9A, 0xDD, 0xE6, 0x29, 
                0x6A, 0xAD, 0xEE, 0x31, 0x7A, 0x8D, 0xD6, 0x19, 0xAA, 0xFD, 0x0E, 0x51, 0xFA, 0x1D, 0xA6, 0xC9, 
                0x6A, 0x8D, 0x2E, 0xB1, 0xDA, 0x6D, 0xF6, 0x19, 0xAA, 0x3D, 0x4E, 0xD1, 0x5A, 0xDD, 0x66, 0xE9, 
                0x6A, 0xED, 0x6E, 0xF1, 0x7A, 0x8D, 0x16, 0x99, 0x2A, 0xBD, 0xCE, 0x51, 0xFA, 0x1D, 0xA6, 0xC9, 
                0x6A, 0x8D, 0x2E, 0x71, 0x9A, 0x2D, 0x76, 0x99, 0x2A, 0x7D, 0x8E, 0xD1, 0x1A, 0x5D, 0xE6, 0x29, 
                0x6A, 0xAD, 0xEE, 0x31, 0x7A, 0x8D, 0xD6, 0x19, 0x2A, 0x7D, 0x8E, 0xD1, 0xFA, 0x1D, 0x26, 0x49, 
                0x6A, 0x8D, 0xAE, 0xB1, 0xDA, 0xED, 0xF6, 0x19, 0x2A, 0x3D, 0x4E, 0x51, 0x5A, 0x5D, 0x66, 0x69, 
                0x6A, 0x6D, 0x6E, 0x71, 0x7A, 0x8D, 0x96, 0x99, 0xAA, 0xBD, 0xCE, 0xD1, 0xFA, 0x1D, 0x26, 0x49, 
                0x6A, 0x8D, 0xAE, 0xF1, 0x1A, 0x2D, 0x76, 0x99, 0xAA, 0xFD, 0x0E, 0x51, 0x9A, 0xDD, 0xE6, 0x29, 
                0x6A, 0xAD, 0xEE, 0x31, 0x7A, 0x8D, 0xD6, 0x19, 0xAA, 0xFD, 0x0E, 0x51, 0xFA, 0x1D, 0xA6, 0xC9, 
                0x6A, 0x8D, 0x2E, 0xB1, 0xDA, 0x6D, 0xF6, 0x19, 0xAA, 0x3D, 0x4E, 0xD1, 0x5A, 0xDD, 0x66, 0xE9, 
                0x6A, 0xED, 0x6E, 0xF1, 0x7A, 0x8D, 0x16, 0x99, 0x2A, 0xBD, 0xCE, 0x51, 0xFA, 0x1D, 0xA6, 0xC9, 
                0x6A, 0x8D, 0x2E, 0x71, 0x9A, 0x2D, 0x76, 0x99, 0x2A, 0x7D, 0x8E, 0xD1, 0x1A, 0x5D, 0xE6, 0x29, 
                0x6A, 0xAD, 0xEE, 0x31, 0x7A, 0x8D, 0xD6, 0x19, 0x2A, 0x7D, 0x8E, 0xD1, 0xFA, 0x1D, 0x26, 0x49, 
                0x6A, 0x8D, 0xAE, 0xB1, 0xDA, 0xED, 0xF6, 0x19, 0x2A, 0x3D, 0x4E, 0x51, 0x5A, 0x5D, 0x66, 0x69, 
            };
            Encryption_Table[0x77] = new Int16[256] { 
                0x77, 0x76, 0x7B, 0x7E, 0x87, 0x8E, 0x93, 0xA6, 0xB7, 0xC6, 0xEB, 0xFE, 0x07, 0x2E, 0x33, 0x56, 
                0x77, 0x96, 0xBB, 0xDE, 0xE7, 0x0E, 0x53, 0x66, 0xB7, 0xC6, 0x0B, 0x5E, 0x67, 0xAE, 0xF3, 0x36, 
                0x77, 0xB6, 0xFB, 0x3E, 0x47, 0x8E, 0xD3, 0x66, 0xB7, 0xC6, 0x6B, 0xBE, 0xC7, 0x6E, 0xB3, 0xD6, 
                0x77, 0x96, 0x3B, 0x5E, 0xE7, 0x0E, 0x93, 0x26, 0xB7, 0xC6, 0x4B, 0xDE, 0x67, 0xEE, 0x73, 0xF6, 
                0x77, 0xF6, 0x7B, 0xFE, 0x07, 0x8E, 0x13, 0xA6, 0x37, 0x46, 0xEB, 0x7E, 0x87, 0x2E, 0xB3, 0xD6, 
                0x77, 0x96, 0x3B, 0x5E, 0xE7, 0x0E, 0x53, 0xE6, 0x37, 0x46, 0x8B, 0xDE, 0x67, 0xAE, 0xF3, 0x36, 
                0x77, 0xB6, 0xFB, 0x3E, 0x47, 0x8E, 0xD3, 0xE6, 0x37, 0x46, 0x6B, 0xBE, 0xC7, 0xEE, 0x33, 0x56, 
                0x77, 0x96, 0xBB, 0xDE, 0xE7, 0x0E, 0x13, 0x26, 0x37, 0x46, 0x4B, 0x5E, 0x67, 0x6E, 0x73, 0x76, 
                0x77, 0x76, 0x7B, 0x7E, 0x87, 0x8E, 0x93, 0xA6, 0xB7, 0xC6, 0xEB, 0xFE, 0x07, 0x2E, 0x33, 0x56, 
                0x77, 0x96, 0xBB, 0xDE, 0xE7, 0x0E, 0x53, 0x66, 0xB7, 0xC6, 0x0B, 0x5E, 0x67, 0xAE, 0xF3, 0x36, 
                0x77, 0xB6, 0xFB, 0x3E, 0x47, 0x8E, 0xD3, 0x66, 0xB7, 0xC6, 0x6B, 0xBE, 0xC7, 0x6E, 0xB3, 0xD6, 
                0x77, 0x96, 0x3B, 0x5E, 0xE7, 0x0E, 0x93, 0x26, 0xB7, 0xC6, 0x4B, 0xDE, 0x67, 0xEE, 0x73, 0xF6, 
                0x77, 0xF6, 0x7B, 0xFE, 0x07, 0x8E, 0x13, 0xA6, 0x37, 0x46, 0xEB, 0x7E, 0x87, 0x2E, 0xB3, 0xD6, 
                0x77, 0x96, 0x3B, 0x5E, 0xE7, 0x0E, 0x53, 0xE6, 0x37, 0x46, 0x8B, 0xDE, 0x67, 0xAE, 0xF3, 0x36, 
                0x77, 0xB6, 0xFB, 0x3E, 0x47, 0x8E, 0xD3, 0xE6, 0x37, 0x46, 0x6B, 0xBE, 0xC7, 0xEE, 0x33, 0x56, 
                0x77, 0x96, 0xBB, 0xDE, 0xE7, 0x0E, 0x13, 0x26, 0x37, 0x46, 0x4B, 0x5E, 0x67, 0x6E, 0x73, 0x76, 
            };
            Encryption_Table[0xFF] = new Int16[256] { 
                0xFF, 0xFE, 0x03, 0x06, 0x0F, 0x16, 0x1B, 0x2E, 0x3F, 0x4E, 0x53, 0x66, 0x8F, 0x96, 0xBB, 0xDE, 
                0xFF, 0x1E, 0x23, 0x46, 0x6F, 0xB6, 0xDB, 0xEE, 0x3F, 0x4E, 0x93, 0xA6, 0xEF, 0x36, 0x7B, 0xBE, 
                0xFF, 0x3E, 0x43, 0x86, 0xCF, 0x16, 0x5B, 0xEE, 0x3F, 0x4E, 0x93, 0x26, 0x4F, 0x96, 0x3B, 0x5E, 
                0xFF, 0x1E, 0xA3, 0xC6, 0x6F, 0xF6, 0x1B, 0xAE, 0x3F, 0x4E, 0xD3, 0x66, 0xEF, 0x76, 0xFB, 0x7E, 
                0xFF, 0x7E, 0x83, 0x06, 0x8F, 0x16, 0x9B, 0x2E, 0xBF, 0xCE, 0x53, 0xE6, 0x0F, 0x96, 0x3B, 0x5E, 
                0xFF, 0x1E, 0xA3, 0xC6, 0x6F, 0xB6, 0xDB, 0x6E, 0xBF, 0xCE, 0x13, 0xA6, 0xEF, 0x36, 0x7B, 0xBE, 
                0xFF, 0x3E, 0x43, 0x86, 0xCF, 0x16, 0x5B, 0x6E, 0xBF, 0xCE, 0x13, 0x26, 0x4F, 0x96, 0xBB, 0xDE, 
                0xFF, 0x1E, 0x23, 0x46, 0x6F, 0x76, 0x9B, 0xAE, 0xBF, 0xCE, 0xD3, 0xE6, 0xEF, 0xF6, 0xFB, 0xFE, 
                0xFF, 0xFE, 0x03, 0x06, 0x0F, 0x16, 0x1B, 0x2E, 0x3F, 0x4E, 0x53, 0x66, 0x8F, 0x96, 0xBB, 0xDE, 
                0xFF, 0x1E, 0x23, 0x46, 0x6F, 0xB6, 0xDB, 0xEE, 0x3F, 0x4E, 0x93, 0xA6, 0xEF, 0x36, 0x7B, 0xBE, 
                0xFF, 0x3E, 0x43, 0x86, 0xCF, 0x16, 0x5B, 0xEE, 0x3F, 0x4E, 0x93, 0x26, 0x4F, 0x96, 0x3B, 0x5E, 
                0xFF, 0x1E, 0xA3, 0xC6, 0x6F, 0xF6, 0x1B, 0xAE, 0x3F, 0x4E, 0xD3, 0x66, 0xEF, 0x76, 0xFB, 0x7E, 
                0xFF, 0x7E, 0x83, 0x06, 0x8F, 0x16, 0x9B, 0x2E, 0xBF, 0xCE, 0x53, 0xE6, 0x0F, 0x96, 0x3B, 0x5E, 
                0xFF, 0x1E, 0xA3, 0xC6, 0x6F, 0xB6, 0xDB, 0x6E, 0xBF, 0xCE, 0x13, 0xA6, 0xEF, 0x36, 0x7B, 0xBE, 
                0xFF, 0x3E, 0x43, 0x86, 0xCF, 0x16, 0x5B, 0x6E, 0xBF, 0xCE, 0x13, 0x26, 0x4F, 0x96, 0xBB, 0xDE, 
                0xFF, 0x1E, 0x23, 0x46, 0x6F, 0x76, 0x9B, 0xAE, 0xBF, 0xCE, 0xD3, 0xE6, 0xEF, 0xF6, 0xFB, 0xFE, 
            };

            //Initialize the rest of the Encryption table with -1.
            for (int i = 0; i < 256; i++)
            {
                if (Encryption_Table[i] != null) continue;
                Encryption_Table[i] = new Int16[256];
                for (int j = 0; j < 256; j++)
                    Encryption_Table[i][j] = -1;
                for (int j = 0; j < 16; j++)    //Exactly one 16th of the undefined tables is known.
                    Encryption_Table[i][j << 4] = (Int16)i;
            }
            //Initialize the Decryption table;
            for (int i = 0; i < 256; i++)
            {
                Decryption_Table[i] = new Int16[256];
                for (int j = 0; j < 256; j++)
                    Decryption_Table[i][j] = -1;
            }
            //And for knowen Ecryption table values, populate the decryption table.
            for (int i = 0; i < 256; i++)
                for (int j = 0; j < 256; j++)
                {
                    if (Encryption_Table[i][j] >= 0)
                        Decryption_Table[j][Encryption_Table[i][j]] = (Byte)i;
                }
            #endregion

            bool print_decryption_table = false ;
            bool print_identical_table = false;
            bool enable_test_menu = false;

            #region print_decryption_table

            String dec_table = "";
            Int16[] result = new Int16[256];
            for (int j = 0; j < 256; j++)
            {
                result[j] = -1;
            }
            if (print_identical_table)
            {
                for (int j = 0; j < 256; j++)
                {
                    if (result[j] == -1)
                    {
                        String Temp = "Comparing Table " + j.ToString("X2") + ", These Tables are Identical: ";
                        for (int i = j + 1; i < 256; i++)
                        {
                            for (int h = 0; h < 256; h++)
                            {
                                if (Decryption_Table[j][h] == Decryption_Table[i][h])
                                {
                                    if (h == 255)
                                    {
                                        result[i] = (Int16)i;
                                        Temp += i.ToString("X2") + " ";
                                    }
                                    else
                                        continue;
                                }
                                else
                                    break;
                            }
                        }
                        Temp += "\n";
                        dec_table += Temp;
                    }
                }
            }

            if (print_decryption_table)
            {
                for (int j = 0; j < 256; j++)
                {
                    String Temp = "            Decryption_Table[0x" + j.ToString("X2") + "] = new Int16[256] { ";
                    for (int i = 0; i < 256; i++)
                    {
                        if ((i % 16) == 0)
                            Temp += "\n                ";
                        if (Decryption_Table[j][i] >= 0)
                            Temp += "0x" + Decryption_Table[j][i].ToString("X2") + ", ";
                        else
                            Temp += "-1,   ";
                    }
                    Temp += "\n            };\n";
                    dec_table += Temp;
                }
            }
            if (print_identical_table || print_decryption_table)
            {
                richTextBox1.Text += dec_table;
                richTextBox1.Visible = true;
                picBox2.Visible = false;
            }
            toolStripTextBox1.Visible = enable_test_menu;
            #endregion


            #region character_stats
            strStats[(int)AntennaPower.no_antenna] = new String[27] {
                "HP:29 AP:0 Att:11 Def:13 Spd:3 Ev:0",
                "HP:32 AP:0 Att:12 Def:13 Spd:3 Ev:0",
                "HP:35 AP:0 Att:12 Def:14 Spd:3 Ev:0",
                "HP:37 AP:0 Att:12 Def:15 Spd:2 Ev:0",
                "HP:40 AP:0 Att:13 Def:16 Spd:2 Ev:0",
                "HP:24 AP:0 Att:10 Def:12 Spd:3 Ev:3",
                "HP:27 AP:0 Att:10 Def:13 Spd:3 Ev:3",
                "HP:29 AP:0 Att:10 Def:13 Spd:3 Ev:3",
                "HP:32 AP:0 Att:10 Def:13 Spd:3 Ev:3",
                "HP:35 AP:0 Att:11 Def:14 Spd:2 Ev:3",
                "HP:35 AP:0 Att:10 Def:15 Spd:3 Ev:3",
                "HP:37 AP:0 Att:11 Def:15 Spd:2 Ev:3",
                "HP:21 AP:0 Att:9 Def:11 Spd:3 Ev:6",
                "HP:24 AP:0 Att:9 Def:12 Spd:3 Ev:6",
                "HP:27 AP:0 Att:9 Def:12 Spd:3 Ev:6",
                "HP:27 AP:0 Att:10 Def:13 Spd:3 Ev:6",
                "HP:27 AP:0 Att:9 Def:13 Spd:2 Ev:6",
                "HP:27 AP:0 Att:9 Def:11 Spd:3 Ev:6",
                "HP:29 AP:0 Att:10 Def:13 Spd:2 Ev:6",
                "HP:29 AP:0 Att:9 Def:13 Spd:2 Ev:6",
                "HP:32 AP:0 Att:10 Def:14 Spd:2 Ev:6",
                "HP:18 AP:0 Att:9 Def:11 Spd:3 Ev:10",
                "HP:24 AP:0 Att:9 Def:12 Spd:3 Ev:10",
                "HP:27 AP:0 Att:9 Def:12 Spd:3 Ev:10",
                "HP:16 AP:0 Att:8 Def:10 Spd:3 Ev:16",
                "HP:18 AP:0 Att:8 Def:11 Spd:3 Ev:16",
                "HP:21 AP:0 Att:8 Def:11 Spd:3 Ev:16"
            };
            intStats[(int)AntennaPower.no_antenna] = new int[27] { 
                384, 320, 321, 322, 385, 325, 3, 0, 1, 2, 
                326, 324, 9, 10, 6, 7, 11, 327, 8, 330, 
                328, 329, 333, 387, 386, 331, 332
            };

            strStats[(int)AntennaPower.revive_single] = new String[52] {
                "HP:25 AP:"," Att:9 Def:9 Spd:4 Ev:0",
                "HP:27 AP:"," Att:10 Def:9 Spd:4 Ev:0",
                "HP:29 AP:"," Att:10 Def:9 Spd:4 Ev:0",
                "HP:32 AP:"," Att:10 Def:10 Spd:3 Ev:0",
                "HP:34 AP:"," Att:11 Def:11 Spd:3 Ev:0",
                "HP:20 AP:"," Att:9 Def:8 Spd:4 Ev:3",
                "HP:23 AP:"," Att:9 Def:9 Spd:4 Ev:3",
                "HP:25 AP:"," Att:9 Def:9 Spd:4 Ev:3",
                "HP:27 AP:"," Att:9 Def:9 Spd:4 Ev:3",
                "HP:29 AP:"," Att:9 Def:9 Spd:3 Ev:3",
                "HP:29 AP:"," Att:9 Def:10 Spd:4 Ev:3",
                "HP:32 AP:"," Att:9 Def:10 Spd:3 Ev:3",
                "HP:18 AP:"," Att:8 Def:8 Spd:4 Ev:6",
                "HP:20 AP:"," Att:8 Def:8 Spd:4 Ev:6",
                "HP:23 AP:"," Att:8 Def:9 Spd:3 Ev:6",
                "HP:23 AP:"," Att:8 Def:8 Spd:4 Ev:6",
                "HP:23 AP:"," Att:9 Def:9 Spd:4 Ev:6",
                "HP:25 AP:"," Att:9 Def:9 Spd:3 Ev:6",
                "HP:25 AP:"," Att:8 Def:9 Spd:3 Ev:6",
                "HP:27 AP:"," Att:9 Def:9 Spd:3 Ev:6",
                "HP:16 AP:"," Att:8 Def:7 Spd:4 Ev:10",
                "HP:20 AP:"," Att:8 Def:8 Spd:4 Ev:10",
                "HP:23 AP:"," Att:8 Def:8 Spd:4 Ev:10",
                "HP:13 AP:"," Att:7 Def:7 Spd:4 Ev:16",
                "HP:16 AP:"," Att:7 Def:7 Spd:4 Ev:16",
                "HP:18 AP:"," Att:7 Def:8 Spd:4 Ev:16"
            };
            intStats[(int)AntennaPower.revive_single] = new int[26] { 384, 320, 321, 322, 385, 325, 
                3, 0, 1, 2, 326, 324, 9, 10, 11, 6, 7, 8, 330, 328, 
                329, 333, 387, 386, 331, 332 
            };

            strStats[(int)AntennaPower.attack_water_single] = new String[54] { 
                "HP:17 AP:"," Att:9 Def:12 Spd:3 Ev:0",
                "HP:19 AP:"," Att:10 Def:12 Spd:3 Ev:0",
                "HP:20 AP:"," Att:10 Def:13 Spd:3 Ev:0",
                "HP:22 AP:"," Att:10 Def:14 Spd:2 Ev:0",
                "HP:24 AP:"," Att:11 Def:15 Spd:2 Ev:0",
                "HP:14 AP:"," Att:9 Def:11 Spd:3 Ev:3",
                "HP:16 AP:"," Att:9 Def:12 Spd:3 Ev:3",
                "HP:17 AP:"," Att:9 Def:12 Spd:3 Ev:3",
                "HP:19 AP:"," Att:9 Def:12 Spd:3 Ev:3",
                "HP:20 AP:"," Att:9 Def:13 Spd:2 Ev:3",
                "HP:20 AP:"," Att:9 Def:14 Spd:3 Ev:3",
                "HP:22 AP:"," Att:9 Def:14 Spd:2 Ev:3",
                "HP:12 AP:"," Att:8 Def:10 Spd:3 Ev:6",
                "HP:14 AP:"," Att:8 Def:11 Spd:3 Ev:6",
                "HP:16 AP:"," Att:8 Def:11 Spd:3 Ev:6",
                "HP:16 AP:"," Att:9 Def:12 Spd:3 Ev:6",
                "HP:16 AP:"," Att:8 Def:12 Spd:2 Ev:6",
                "HP:16 AP:"," Att:8 Def:10 Spd:3 Ev:6",
                "HP:17 AP:"," Att:9 Def:12 Spd:2 Ev:6",
                "HP:17 AP:"," Att:8 Def:12 Spd:2 Ev:6",
                "HP:19 AP:"," Att:9 Def:13 Spd:2 Ev:6",
                "HP:11 AP:"," Att:8 Def:10 Spd:3 Ev:10",
                "HP:14 AP:"," Att:8 Def:11 Spd:3 Ev:10",
                "HP:16 AP:"," Att:8 Def:11 Spd:3 Ev:10",
                "HP:9 AP:"," Att:7 Def:9 Spd:3 Ev:16",
                "HP:11 AP:"," Att:7 Def:10 Spd:3 Ev:16",
                "HP:12 AP:"," Att:7 Def:10 Spd:3 Ev:16"
            };
            intStats[(int)AntennaPower.attack_water_single] = new int[27] { 
                384, 320, 321, 322, 385, 325, 3, 0, 
                1, 2, 326, 324, 9, 10, 6, 7, 
                11, 327, 8, 330, 328, 329, 333, 387, 
                386, 331, 332
            };
            #endregion

        }
        
        #region Menu -> File

        private void menuFileNew_Click(object sender, EventArgs e)
        {
            var data = new Byte[0x6A];
            QRByteArray = data;
            if (hexBox1.ByteProvider != null)
            {
                IDisposable byteProvider = hexBox1.ByteProvider as IDisposable;
                if (byteProvider != null)
                    byteProvider.Dispose();
                hexBox1.ByteProvider = null;
            }
            hexBox1.ByteProvider = new Be.Windows.Forms.DynamicByteProvider(QRByteArray);
            cboColor.SelectedIndex = -1;
            
            cboHeadShape.SelectedIndex = -1;
            cboFaceShapeHairStyle.SelectedIndex = -1;
            cboHairColor.SelectedIndex = -1;
            cboEyes.SelectedIndex = -1;
            cboEyeBrows.SelectedIndex = -1;
            cboNose.SelectedIndex = -1;
            cboFaceColor.SelectedIndex = -1;
            cboMouth.SelectedIndex = -1;
            cboCheeks.SelectedIndex = -1;
            cboGlasses.SelectedIndex = -1;
            cboAntennaPower.SelectedIndex = -1;
            nudStats.Value = -1;
            txtName.Text = "New Denpa";    //Cannot leave the name field in the QR data totally blank or else the game locks up instantly.

            switch (CultureInfo.CurrentCulture.Name)
            {
                case "":
                case "en":
                case "fr":
                case "es":
                    cboRegion.SelectedIndex = -1;
                    break;

                case "ja":
                case "ja-JP":
                    cboRegion.SelectedIndex = 1;
                    break;

                case "en-CA":
                case "en-US":
                case "fr-CA":
                case "es-MX":
                case "es-AR":
                case "en-BZ":
                case "es-BO":
                case "pt-BR":
                case "es-CL":
                case "es-CO":
                case "es-CR":
                case "es-DO":
                case "es-EC":
                case "es-SV":
                case "es-GT":
                case "es-HN":
                case "en-JM":
                case "ms-MY":
                case "es-NI":
                case "es-PA":
                case "es-PY":
                case "es-PE":
                case "es-SA":
                case "zh-SG":
                case "es-TT":
                case "es-UY":
                case "es-VE":
                    cboRegion.SelectedIndex = 0;
                    break;

                default:
                    cboRegion.SelectedIndex = 2;
                    break;
            }

            if ((CultureInfo.CurrentCulture.Name == "ja") || (CultureInfo.CurrentCulture.Name == "ja-JP"))
                cboRegion.SelectedIndex = 1;
            else
                cboRegion.SelectedIndex = 0;

            btnChangeID_Click(sender, e);
            StatusStripLabel.Text = "";
            
        }

        private void menuFileExit_Click(object sender, EventArgs e)
        {
            Application.Exit();
        }

        #endregion

        #region Menu -> QR Code

        private byte[] encrypt_byte_array(byte[] bytearray)
        {
            Random random = new Random();
            for (int i = 0; i < (bytearray.Length / 2); i++)
            {
                if (Encryption_Table[bytearray[i * 2]] != null)
                {
                    if (Decryption_Table[bytearray[i * 2]][bytearray[(i * 2) + 1]] >= 0)
                    {
                        Byte j = (Byte)random.Next(0, 255);
                        if (Encryption_Table[i][j] >= 0)
                        {
                            bytearray[(i * 2) + 1] = j;
                            bytearray[(i * 2)] = (Byte)Encryption_Table[i][j];
                        }
                    }
                }
            }
            return bytearray;
        }

        private byte[] decrypt_byte_array(byte[] bytearray)
        {
            for (int i = 0; i < (bytearray.Length / 2); i++)
            {
                if (Decryption_Table[bytearray[(i * 2) + 1]][bytearray[i * 2]] >= 0)
                {
                    bytearray[(i * 2)] = (Byte)Decryption_Table[bytearray[(i * 2) + 1]][bytearray[i * 2]];
                    bytearray[(i * 2) + 1] = 0;
                }
            }
            //int i;
            //if (bytearray == null)
            //    return null;
            //for (i = 0; i < (bytearray.Length / 2); i++)
            //{
            //    switch (bytearray[(i * 2) + 1])
            //    {
            //        case 0x00:
            //        case 0x10:
            //        case 0x20:
            //        case 0x30:
            //        case 0x40:
            //        case 0x50:
            //        case 0x60:
            //        case 0x70:
            //        case 0x80:
            //        case 0x90:
            //        case 0xA0:
            //        case 0xB0:
            //        case 0xC0:
            //        case 0xD0:
            //        case 0xE0:
            //        case 0xF0:
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x01:
            //        case 0x81:
            //            bytearray[(i * 2)] = (byte)((bytearray[(i * 2)] ^ 1) - (((bytearray[(i * 2)] & 1) == 1) ? 2 : 0));
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x02:
            //        case 0x82:
            //            bytearray[(i * 2) + 0] -= 4;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x03:
            //        case 0x83:
            //            bytearray[(i * 2) + 0] -= (byte)(((bytearray[(i * 2) + 0] % 4)== 3)?15:7);
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x04:
            //        case 0x84:
            //            bytearray[(i * 2) + 0] -= 16;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x05:
            //        case 0x45:
            //        case 0x85: 
            //        case 0xC5:
            //            var sub_table = new byte[16] { 0x17, 0x13, 0x18, 0x1B, 0x17, 0x23, 0x17, 0x1B, 0x17, 0x13, 0x17, 0x1B, 0x17, 0x23, 0x17, 0x1B };
            //            bytearray[(i * 2) + 0] -= sub_table[bytearray[(i * 2) + 0] & 0x0F];
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x25:
            //        case 0x65:
            //        case 0xA5:
            //        case 0xE5:
            //            break;
            //        case 0x06:
            //        case 0x86:
            //            bytearray[(i * 2) + 0] -= (byte)(((bytearray[(i * 2) + 0] % 8) < 4) ? 0x1C : 0x2C);
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x07:
            //        case 0x47:
            //        case 0x87:
            //        case 0xC7:
            //            bytearray[(i * 2) + 0] -= (byte)(((bytearray[(i * 2) + 0] % 8) == 7) ? 0x3F : 0x2F);
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x08:
            //        case 0x18:
            //        case 0x28:
            //        case 0x38:
            //        case 0x88:
            //        case 0x98:
            //        case 0xA8:
            //        case 0xB8:
            //            bytearray[(i * 2) + 0] -= 64;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x09:
            //        case 0x29:
            //        case 0x89:
            //        case 0xA9:
            //            var sub_table_09 = new byte[16] { 0x4F, 0x43, 0x4F, 0x53, 0x4F, 0x53, 0x4F, 0x53, 0x4F, 0x63, 0x4F, 0x53, 0x4F, 0x53, 0x4F, 0x53 };
            //            bytearray[(i * 2) + 0] -= sub_table_09[bytearray[(i * 2) + 0] & 0x0F];
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x0F:
            //        case 0x2F:
            //        case 0x4F:
            //        case 0x6F:
            //        case 0x8F:
            //        case 0xAF:
            //        case 0xCF:
            //        case 0xEF:
            //            bytearray[(i * 2)] += 0x21;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x11:
            //        case 0x71:
            //        case 0x91:
            //        case 0xF1:
            //            var offset = bytearray[(i * 2)];
            //            bytearray[(i * 2)] = (byte)((bytearray[(i * 2)] ^ 1) - (((bytearray[(i * 2)] & 1) == 1) ? 2 : 0));
            //            if((offset & 0x1F) != 0x01)
            //                bytearray[(i * 2)] -= 0x20;
            //            if ((offset & 0x1F) == 0x11)
            //                bytearray[(i * 2)] -= 0x30;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x3F:
            //        case 0xBF:
            //            bytearray[(i * 2)] += 0x81;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;

            //        case 0x1F:
            //        case 0x5F:
            //        case 0x9F:
            //        case 0xDF:
            //            bytearray[(i * 2)] += 0x41;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
                    
                    
                    
            //        case 0x77:
            //        case 0xF7:
            //            if ((bytearray[(i * 2)] % 8) == 7)
            //                bytearray[(i * 2)] += 0x61;
            //            else
            //                bytearray[(i * 2)] += 0x51;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x78:
            //        case 0xF8:
            //            bytearray[(i * 2) + 0] += 0x40;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x79:
            //        case 0xF9:
            //            if ((bytearray[(i * 2)] % 8) == 1)
            //                bytearray[(i * 2)] += 0x3D;
            //            else if ((bytearray[(i * 2)] % 2) == 0)
            //                bytearray[(i * 2)] += 0x31;
            //            else
            //                bytearray[(i * 2)] += 0x2D;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x7A:
            //        case 0xFA:
            //            if ((bytearray[(i * 2)] % 8) < 4)
            //                bytearray[(i * 2)] += 0x2C;
            //            else
            //                bytearray[(i * 2)] += 0x1C;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x7B:
            //        case 0xFB:
            //            if ((bytearray[(i * 2)] % 8) == 3)
            //                bytearray[(i * 2)] += 0x21;
            //            else if ((bytearray[(i * 2)] % 8) == 7)
            //                bytearray[(i * 2)] += 0x11;
            //            else
            //                bytearray[(i * 2)] += 0x19;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x7C:
            //        case 0xFC:
            //            bytearray[(i * 2) + 0] += 16;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x7D:
            //        case 0xFD:
            //            if ((bytearray[(i * 2)] % 4) == 1)
            //                bytearray[(i * 2)] += 0x0D;
            //            else if ((bytearray[(i * 2)] % 4) == 3)
            //                bytearray[(i * 2)] += 0x05;
            //            else
            //                bytearray[(i * 2)] += 0x09;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x3E:
            //        case 0x7E:
            //        case 0xBE:
            //        case 0xFE:
            //            bytearray[(i * 2) + 0] += 4;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        case 0x7F:
            //        case 0xFF:
            //            bytearray[(i * 2) + 0] += 1;
            //            bytearray[(i * 2) + 1] = 0;
            //            break;
            //        default:
            //            break;
            //    }
               
            //}

            return bytearray;
        }

        private ByteMatrix GetQRMatrix(int size)
        {
            var writer = new QRCodeWriter();
            const string encoding = "ISO-8859-1";
            if (hexBox1.ByteProvider == null)
                return null;
            if (hexBox1.ByteProvider.Length == 0)
                return null;
            QRByteArray = new Byte[0];
            var data = new Byte[0];
            for (int i = 0; i < hexBox1.ByteProvider.Length; i++)
            {
                data = new Byte[QRByteArray.Length + 1];
                QRByteArray.CopyTo(data, 0);
                data[i] = hexBox1.ByteProvider.ReadByte(i);
                QRByteArray = data;
            }

            data = QRByteArray;
            if (data == null)
                return null;
            var str = Encoding.GetEncoding(encoding).GetString(data);
            var hints = new Hashtable { { EncodeHintType.CHARACTER_SET, encoding } };
            return writer.encode(str, BarcodeFormat.QR_CODE, size, size, hints); 
        }

        #endregion


        #region Check for updates
        private void bwCheckForUpdates_DoWork(object sender, DoWorkEventArgs e)
        {
        }

        private bool IsNewerAvailable(string newerVersion)
        {
            var thisVersion = Version.Parse(Application.ProductVersion);
            var remoteVersion = Version.Parse(newerVersion);
            return remoteVersion.CompareTo(thisVersion) > 0;
        }

        private void bwCheckForUpdates_RunWorkerCompleted(object sender, RunWorkerCompletedEventArgs e)
        {
        }
        #endregion

        public bool ByteArrayToFile(string _FileName, byte[] _ByteArray)
        {
            try
            {
                // Open file for reading
                System.IO.FileStream _FileStream = new System.IO.FileStream(_FileName, System.IO.FileMode.Create, System.IO.FileAccess.Write);

                // Writes a block of bytes to this stream using data from a byte array.
                _FileStream.Write(_ByteArray, 0, _ByteArray.Length);

                // close file stream
                _FileStream.Close();

                return true;
            }
            catch (Exception _Exception)
            {
                // Error
                Console.WriteLine("Exception caught in process: {0}", _Exception.ToString());
            }

            // error occured, return false
            return false;
        }

        private void toolStripTextBox1_Click(object sender, EventArgs e)
        {
            
        }

        private void propertyGrid_Click(object sender, EventArgs e)
        {

        }

        private void hexBox1_KeyPress(object sender, KeyPressEventArgs e)
        {
            var matrix = GetQRMatrix(100);
            if (matrix == null)
                return;
            var img = new Bitmap(100,100);
            var g = Graphics.FromImage(img);
            g.Clear(Color.White);
            for (var y = 0; y < matrix.Height; ++y)
                for (var x = 0; x < matrix.Width; ++x)
                    if (matrix.get_Renamed(x, y) != -1)
                        g.FillRectangle(Brushes.Black, x * 1, y * 1, 1, 1);
            if (btnSwitchPicBox.Text == "Feature")
                picBox.Image = img;
            else
                picBox.Image = picBox2.Image;
            qr_code = img;
        }

        private void hexBox1_KeyUp(object sender, KeyEventArgs e)
        {
            hexBox1_KeyPress(sender,null);
        }

        private void saveQRCodeToolStripMenuItem_Click(object sender, EventArgs e)
        {
            var sfd = new SaveFileDialog { Filter = "PNG Files|*.png|Jpeg Files|*.jpg|Bitmap Files|*.bmp|GIF Files|*.gif" };
            if (sfd.ShowDialog() != DialogResult.OK) return;
            var imgFormat = ImageFormat.Png;
            switch (Path.GetExtension(sfd.FileName))
            {
                case ".jpg":
                    imgFormat = ImageFormat.Jpeg;
                    break;
                case ".png":
                    imgFormat = ImageFormat.Png;
                    break;
                case ".bmp":
                    imgFormat = ImageFormat.Bmp;
                    break;
                case ".gif":
                    imgFormat = ImageFormat.Gif;
                    break;
            }
            try
            {
                qr_code.Save(sfd.FileName, imgFormat);
            }
            catch
            {
            }
        }

        private int IsQRDenpa(Byte[] byteArray)
        {
            if (byteArray.Length == 0x6A)
            {
                if ((byteArray[1] == 0) && (byteArray[3] == 0) && (byteArray[5] == 0) && (byteArray[7] == 0))
                {
                    if ((byteArray[0] == 'A') && (byteArray[2] == 'h') && (byteArray[4] == '4') && (byteArray[6] == '3'))
                        return 0;
                    if ((byteArray[0] == 'b') && (byteArray[2] == 'X') && (byteArray[4] == '8') && (byteArray[6] == '0'))
                        return 1;
                    if ((byteArray[0] == 'j') && (byteArray[2] == '3') && (byteArray[4] == 'Z') && (byteArray[6] == 'w'))
                        return 2;
                }
            }
            return -1;
        }

        private void openQRCodeToolStripMenuItem_Click(object sender, EventArgs e)
        {
            var ofd = new OpenFileDialog { Filter = "All Supported|*.png;*.jpg;*.bmp;*.gif|PNG Files|*.png|Jpeg Files|*.jpg|Bitmap Files|*.bmp|GIF Files|*.gif" };
            if (ofd.ShowDialog() != DialogResult.OK) return;
            try
            {
                var file = new FileStream(ofd.FileName, FileMode.Open);
                var bmp = new Bitmap(Image.FromStream(file));
                file.Close();
                var binary = new BinaryBitmap(new HybridBinarizer(new RGBLuminanceSource(bmp, bmp.Width, bmp.Height)));
                var reader = new QRCodeReader();
                var hashtable = new Hashtable();
                hashtable.Add(DecodeHintType.POSSIBLE_FORMATS,BarcodeFormat.QR_CODE);
                hashtable.Add(DecodeHintType.TRY_HARDER,true);
                var result = reader.decode(binary, hashtable);
                var byteArray = (byte[])((ArrayList)result.ResultMetadata[ResultMetadataType.BYTE_SEGMENTS])[0];
                QRByteArray = decrypt_byte_array(byteArray);
                if (IsQRDenpa(byteArray) == -1)
                {
                    MessageBox.Show("Error: Scanned QR code is not recognized as a Denpa men QR code");
                    return;
                }
                if (hexBox1.ByteProvider != null)
                {
                    IDisposable byteProvider = hexBox1.ByteProvider as IDisposable;
                    if (byteProvider != null)
                        byteProvider.Dispose();
                    hexBox1.ByteProvider = null;
                }
                hexBox1.ByteProvider = new Be.Windows.Forms.DynamicByteProvider(QRByteArray);
                hexBox1_KeyPress(sender, null);
                

                var temp = new byte[0];
                temp = new Byte[QRByteArray.Length];
                QRByteArray.CopyTo(temp, 0);    //Make sure any tampering with the combo boxes do NOT mess with this data.
                populate_combo_boxes(temp);
                

            }
            catch (ReaderException ex)
            {
                MessageBox.Show("Error Loading:" + Environment.NewLine + ex.Message);
            }
            catch (InvalidOperationException ex)
            {
                MessageBox.Show("Error Loading:" + Environment.NewLine + ex.Message);
            }
        }

        private void cboColor_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            byte temp;
            int color_index = cboColor.SelectedIndex;
            bool solid_color_enable;
            int antenna_index = cboAntennaPower.SelectedIndex;

            if (color_index == -1) return;
            if (antenna_index == -1) { StatusStripLabel.Text = "Antenna Power required"; return; }
            

            if ((color_index <= 6))
            {
                if ((((antenna_index >= 7) && (antenna_index <= 12)) || ((antenna_index >= 19) && (antenna_index <= 24))))
                {
                    int[][] color_index_table = new int[6][];
                    color_index_table[0] = new int[7] { 6, 1, 0, 2, 3, 4, 5 };
                    color_index_table[1] = new int[7] { 6, 1, 2, 0, 3, 4, 5 };
                    color_index_table[2] = new int[7] { 6, 1, 2, 3, 0, 4, 5 };
                    color_index_table[3] = new int[7] { 6, 1, 2, 3, 4, 0, 5 };
                    color_index_table[4] = new int[7] { 6, 1, 2, 3, 4, 5, 0 };
                    color_index_table[5] = new int[7] { 6, 0, 1, 2, 3, 4, 5 };
                    if (antenna_index <= 12)
                        antenna_index -= 7;
                    else
                        antenna_index -= 19;
                    color_index = color_index_table[antenna_index][color_index];
                }
                solid_color_enable = (color_index != 0);
                //We now modify this index, based upon Antenna power selected.
                temp = hexBox1.ByteProvider.ReadByte(0x12);
                temp &= 0x07;
                temp |= (byte)((color_index - ((solid_color_enable)?1:0)) << 3);
                hexBox1.ByteProvider.WriteByte(0x12,temp);
                hexBox1.ByteProvider.WriteByte(0x13,0);
                if(solid_color_enable)
                    hexBox1.ByteProvider.WriteByte(0x24, 0x5C);
                else
                    hexBox1.ByteProvider.WriteByte(0x24, 0x00);
                hexBox1.ByteProvider.WriteByte(0x25, 0);
            }
            else
            {
                temp = hexBox1.ByteProvider.ReadByte(0x12);
                temp &= 0x07;
                temp |= (byte)((cboColor.SelectedIndex - 7) << 3);
                hexBox1.ByteProvider.WriteByte(0x12, temp);
                hexBox1.ByteProvider.WriteByte(0x13, 0);
                hexBox1.ByteProvider.WriteByte(0x24, 0xDF);
                hexBox1.ByteProvider.WriteByte(0x25, 0);
            }
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
        }

        private void cboAntennaPower_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            cboColor_SelectedIndexChanged(sender, e);  //Colors depend on Antenna power
            cboFaceShapeHairStyle_SelectedIndexChanged(sender, e);  //So does the Hair style.
            StatusStripLabel.Text = ""; 
            int index = cboAntennaPower.SelectedIndex;
            if (index == -1) return;

            String[] AP_head_shape = new String[25] {
                "N/A",
                "7","7","7","7","7","7","7",
                "12","12","12","12",
                "15","15","15","15","15","15","15",
                "20","20","20","24","20","24"
            };

            if (strStats[index] != null)
            {
                cboStats.Items.Clear();
                if (index == 0)
                    cboStats.Items.AddRange(strStats[index]);
                else
                {
                    for (int i = 0; i < intStats[index].Length; i++)
                        cboStats.Items.Add(strStats[index][(i * 2)] + AP_head_shape[cboHeadShape.SelectedIndex + 1] + strStats[index][(i * 2) + 1]); 
                }
                for (int i = 0; i < intStats[index].Length; i++)
                {
                    if ((int)nudStats.Value == intStats[index][i])
                        cboStats.SelectedIndex = i;
                }
            }
            else
            {
                cboStats.Items.Clear();
            }


            int temp = hexBox1.ByteProvider.ReadByte(0x10) & 0xC0;
            if (index == 0)
            {
                hexBox1.ByteProvider.WriteByte(0x28, 0);
                hexBox1.ByteProvider.WriteByte(0x29, 0);
            }
            else if ((index >= 1) && (index <= 12))
            {
                temp |= ((index - 1) & 0x3F);
                hexBox1.ByteProvider.WriteByte(0x10, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x11, 0);
                hexBox1.ByteProvider.WriteByte(0x28, 0xD6);
                hexBox1.ByteProvider.WriteByte(0x29, 0);
            }
            else if ((index >= 13) && (index <= 24))
            {
                temp |= ((index - 13) & 0x3F);
                hexBox1.ByteProvider.WriteByte(0x10, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x11, 0);
                hexBox1.ByteProvider.WriteByte(0x28, 0xD7);
                hexBox1.ByteProvider.WriteByte(0x29, 0);
            }
            else
            {
                temp |= ((index - 25) & 0x3F);
                hexBox1.ByteProvider.WriteByte(0x10, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x11, 0);
                hexBox1.ByteProvider.WriteByte(0x28, 0xD8);
                hexBox1.ByteProvider.WriteByte(0x29, 0);
            }
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
        }

        private void txtName_TextChanged(object sender, EventArgs e)
        {
            if (populating) return;
            if (txtName.TextLength > 0)
            {
                byte[] unicode_str = System.Text.Encoding.Unicode.GetBytes(txtName.Text);
                
                for (int i = 0; i < txtName.TextLength; i++)
                {
                    hexBox1.ByteProvider.WriteByte(0x34 + (i*4), unicode_str[(i*2)]);
                    hexBox1.ByteProvider.WriteByte(0x35 + (i * 4), 0);
                    hexBox1.ByteProvider.WriteByte(0x36 + (i * 4), unicode_str[(i*2)+1]);
                    hexBox1.ByteProvider.WriteByte(0x37 + (i * 4), 0);
                }
                hexBox1.ByteProvider.WriteByte(0x34 + (txtName.TextLength * 4), 0);
                hexBox1.ByteProvider.WriteByte(0x35 + (txtName.TextLength * 4), 0);
                hexBox1.ByteProvider.WriteByte(0x36 + (txtName.TextLength * 4), 0);
                hexBox1.ByteProvider.WriteByte(0x37 + (txtName.TextLength * 4), 0);
                hexBox1.Refresh();
                hexBox1_KeyPress(null, null);
            }
        }

        private void btnSwitchPicBox_Click(object sender, EventArgs e)
        {
            if (btnSwitchPicBox.Text == "QR Code")
            {
                picBox.Image = qr_code;
                btnSwitchPicBox.Text = "Feature";
            }
            else
            {
                picBox.Image = picBox2.Image;
                btnSwitchPicBox.Text = "QR Code";
            }
        }

        private void cboHeadShape_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboHeadShape.SelectedIndex;
            int AntennaIndex = cboAntennaPower.SelectedIndex;
            if (index == -1) return;

            String[] AP_head_shape = new String[25] {
                "N/A",
                "7","7","7","7","7","7","7",
                "12","12","12","12",
                "15","15","15","15","15","15","15",
                "20","20","20","24","20","24"
            };

            if (AntennaIndex != -1)
            {
                if (strStats[AntennaIndex] != null)
                {
                    cboStats.Items.Clear();
                    for (int i = 0; i < intStats[AntennaIndex].Length; i++)
                    {
                        if (AntennaIndex != 0)
                            cboStats.Items.Add(strStats[AntennaIndex][(i * 2)] + AP_head_shape[cboHeadShape.SelectedIndex + 1] + strStats[AntennaIndex][(i * 2) + 1]);
                        else
                            cboStats.Items.Add(strStats[AntennaIndex][i]);
                        if ((int)nudStats.Value == intStats[AntennaIndex][i])
                            cboStats.SelectedIndex = i;
                    }
                }
                else
                {
                    cboStats.Items.Clear();
                }
            }
            else
            {
                cboStats.Items.Clear();
            }


            int temp;
            temp = hexBox1.ByteProvider.ReadByte(0x14);
            temp &= 0xE0;
            if ((index >= 0) && (index <= 10))
            {
                temp |= (index - 0);
                hexBox1.ByteProvider.WriteByte(0x14, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x15, 0);
                hexBox1.ByteProvider.WriteByte(0x26, 0);
                hexBox1.ByteProvider.WriteByte(0x27, 0);
            }
            else if ((index >= 11) && (index <= 17))
            {
                temp |= (index - 11);
                hexBox1.ByteProvider.WriteByte(0x14, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x15, 0);
                hexBox1.ByteProvider.WriteByte(0x26, 0x28);
                hexBox1.ByteProvider.WriteByte(0x27, 0);
            }
            else
            {
                temp |= (index - 18);
                hexBox1.ByteProvider.WriteByte(0x14, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x15, 0);
                hexBox1.ByteProvider.WriteByte(0x26, 0x30);
                hexBox1.ByteProvider.WriteByte(0x27, 0);
            }
            hexBox1.Refresh();
            picBox2.Image = head[index];
            hexBox1_KeyPress(null, null);
        }

        private void newDenpaToolStripMenuItem_Click(object sender, EventArgs e)
        {
            menuFileNew_Click(sender, e);
        }

        private void quitToolStripMenuItem_Click(object sender, EventArgs e)
        {
            menuFileExit_Click(sender, e);
        }

        private void toolStripMenuItem1_Click(object sender, EventArgs e)
        {

        }

      
        private void btnChangeID_Click(object sender, EventArgs e)
        {
            hexBox1.ByteProvider.WriteByte(0x0D, 0x00);
            hexBox1.ByteProvider.WriteByte(0x0F, 0x00);
            Random random = new Random();
            var rand_data = new Byte[1];
            random.NextBytes(rand_data);
            hexBox1.ByteProvider.WriteByte(0x0C, rand_data[0]);
            random.NextBytes(rand_data);
            hexBox1.ByteProvider.WriteByte(0x0E, rand_data[0]);
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
        }

        private void cboFaceShapeHairStyle_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboFaceShapeHairStyle.SelectedIndex;
            int antenna = cboAntennaPower.SelectedIndex;
            
            if (index == -1) return;
            if (antenna == -1) { StatusStripLabel.Text = "Antenna Power required"; return; }
            int temp = hexBox1.ByteProvider.ReadByte(0x14) & 0x1F;
            int temp2 = hexBox1.ByteProvider.ReadByte(0x16) & 0xF8;
            if (index < 9)
            {
                temp |= ((index & 0x7) << 5);
                temp2 |= ((index & 0x18) >> 3);
                hexBox1.ByteProvider.WriteByte(0x14, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x15, 0);
                hexBox1.ByteProvider.WriteByte(0x16, (byte)temp2);
                hexBox1.ByteProvider.WriteByte(0x17, 0);
                hexBox1.ByteProvider.WriteByte(0x2A, 0x00);
                hexBox1.ByteProvider.WriteByte(0x2B, 0);
            }
            else
            {
                temp |= (((index - 9) & 0x7) << 5);
                temp2 |= (((index - 9) & 0x18) >> 3);
                hexBox1.ByteProvider.WriteByte(0x14, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x15, 0);
                hexBox1.ByteProvider.WriteByte(0x16, (byte)temp2);
                hexBox1.ByteProvider.WriteByte(0x17, 0);
                if (antenna == 0)
                    hexBox1.ByteProvider.WriteByte(0x2A, 0x0C);
                else
                    hexBox1.ByteProvider.WriteByte(0x2A, 0x0B);
                hexBox1.ByteProvider.WriteByte(0x2B, 0);
            }
            hexBox1.Refresh();
            picBox2.Image = faceshape[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboHairColor_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboHairColor.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x18) & 0xE0;
            temp |= (index & 0x1F);
            hexBox1.ByteProvider.WriteByte(0x18, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x19, 0);
            hexBox1.Refresh();
            picBox2.Image = haircolor[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboEyes_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboEyes.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x18) & 0x1F;
            temp |= ((index & 0x07) << 5);
            hexBox1.ByteProvider.WriteByte(0x18, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x19, 0);
            temp = hexBox1.ByteProvider.ReadByte(0x1A) & 0xFC;
            temp |= ((index & 0x18) >> 3);
            hexBox1.ByteProvider.WriteByte(0x1A, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x1B, 0);
            hexBox1.Refresh();
            picBox2.Image = eyes[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboEyeBrows_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboEyeBrows.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x1C) & 0x3F;
            temp |= ((index & 0x03) << 6);
            hexBox1.ByteProvider.WriteByte(0x1C, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x1D, 0);
            temp = hexBox1.ByteProvider.ReadByte(0x1E) & 0xFE;
            temp |= ((index & 0x04) >> 2);
            hexBox1.ByteProvider.WriteByte(0x1E, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x1F, 0);
            hexBox1.Refresh();
            picBox2.Image = eye_brow[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboNose_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboNose.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x1C) & 0x87;
            temp |= ((index & 0x0F) << 3);
            hexBox1.ByteProvider.WriteByte(0x1A, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x1B, 0);
            hexBox1.Refresh();
            picBox2.Image = nose[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboFaceColor_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboFaceColor.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x16) & 0xE7;
            if (index < 2)
            {
                hexBox1.ByteProvider.WriteByte(0x30, 0x0C);
                hexBox1.ByteProvider.WriteByte(0x31, 0);
                temp |= ((index & 0x03) << 3);
                hexBox1.ByteProvider.WriteByte(0x16, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x17, 0);
            }
            else
            {
                hexBox1.ByteProvider.WriteByte(0x30, 0x00);
                hexBox1.ByteProvider.WriteByte(0x31, 0);
                temp |= (((index - 2) & 0x03) << 3);
                hexBox1.ByteProvider.WriteByte(0x16, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x17, 0);
            }
            hexBox1.Refresh();
            picBox2.Image = face_color[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboMouth_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboMouth.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x1C) & 0xC0;
            temp |= (index & 0x1F);
            hexBox1.ByteProvider.WriteByte(0x1C, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x1D, 0);
            hexBox1.Refresh();
            picBox2.Image = mouth[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboCheeks_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboCheeks.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x1E) & 0x07;
            if (index < 1)
            {
                hexBox1.ByteProvider.WriteByte(0x2C, 0);
                hexBox1.ByteProvider.WriteByte(0x2D, 0);
                temp |= ((index & 0x07) << 3);
                hexBox1.ByteProvider.WriteByte(0x1E, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x1F, 0);
            }
            else
            {
                hexBox1.ByteProvider.WriteByte(0x2C, 0x5A);
                hexBox1.ByteProvider.WriteByte(0x2D, 0);
                temp |= (((index - 1) & 0x07) << 3);
                hexBox1.ByteProvider.WriteByte(0x1E, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x1F, 0);
            }
            hexBox1.Refresh();
            picBox2.Image = cheek[index];
            hexBox1_KeyPress(null, null);
        }

        private void cboGlasses_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = cboGlasses.SelectedIndex;
            if (index == -1) return;
            int temp = hexBox1.ByteProvider.ReadByte(0x20) & 0xE0;
            if (index < 1)
            {
                hexBox1.ByteProvider.WriteByte(0x2E, 0);
                hexBox1.ByteProvider.WriteByte(0x2F, 0);
                temp |= ((index & 0x1F));
                hexBox1.ByteProvider.WriteByte(0x20, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x21, 0);
            }
            else
            {
                hexBox1.ByteProvider.WriteByte(0x2E, 0x30);
                hexBox1.ByteProvider.WriteByte(0x2F, 0);
                temp |= (((index - 1) & 0x1F));
                hexBox1.ByteProvider.WriteByte(0x20, (byte)temp);
                hexBox1.ByteProvider.WriteByte(0x21, 0);
            }
            hexBox1.Refresh();
            picBox2.Image = glasses[index];
            hexBox1_KeyPress(null, null);
        }

        private void nudStats_ValueChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int index = (int)nudStats.Value;
            int antenna_index = cboAntennaPower.SelectedIndex;
            if (index < 0) return;

            if (antenna_index != -1)
            {
                if (intStats[antenna_index] != null)
                {
                    cboStats.SelectedIndex = -1;
                    for (int i = 0; i < intStats[antenna_index].Length; i++)
                    {
                        if ((int)nudStats.Value == intStats[antenna_index][i])
                        {
                            cboStats.SelectedIndex = i;
                            break;
                        }
                    }
                }
            }

            int temp = hexBox1.ByteProvider.ReadByte(0x10) & 0x3F;
            temp |= ((index & 0x03) << 6);
            hexBox1.ByteProvider.WriteByte(0x10, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x11, 0);
            temp = hexBox1.ByteProvider.ReadByte(0x12) & 0xF8;
            temp |= ((index & 0x1C) >> 2);
            hexBox1.ByteProvider.WriteByte(0x12, (byte)temp);
            hexBox1.ByteProvider.WriteByte(0x13, 0);
            hexBox1.ByteProvider.WriteByte(0x22, (byte)((index & 0x1E0) >> 5));
            hexBox1.ByteProvider.WriteByte(0x23, 0);
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
        }

        private void btnRandomDenpa_Click(object sender, EventArgs e)
        {
            
           
            
            btnChangeID_Click(sender, e);
            Random random = new Random();
            cboAntennaPower.SelectedIndex = random.Next(cboAntennaPower.Items.Count);
            cboColor.SelectedIndex = random.Next(cboColor.Items.Count);
            cboHeadShape.SelectedIndex = random.Next(cboHeadShape.Items.Count);
            cboFaceShapeHairStyle.SelectedIndex = random.Next(cboFaceShapeHairStyle.Items.Count);
            cboHairColor.SelectedIndex = random.Next(cboHairColor.Items.Count);
            cboEyes.SelectedIndex = random.Next(cboEyes.Items.Count);
            cboEyeBrows.SelectedIndex = random.Next(cboEyeBrows.Items.Count);
            cboNose.SelectedIndex = random.Next(cboNose.Items.Count);
            cboFaceColor.SelectedIndex = random.Next(cboFaceColor.Items.Count);
            cboMouth.SelectedIndex = random.Next(cboMouth.Items.Count);
            cboCheeks.SelectedIndex = random.Next(cboCheeks.Items.Count);
            cboGlasses.SelectedIndex = random.Next(cboGlasses.Items.Count);
            nudStats.Value = random.Next(512);
            if (cboRegion.SelectedIndex != 1)
                txtName.Text = north_america_names[random.Next(north_america_names.Length)];
            else
                txtName.Text = jap_names[random.Next(jap_names.Length)];
        }

        private void advancedInterfaceToolStripMenuItem_Click(object sender, EventArgs e)
        {
            hexBox1.Visible = !advancedInterfaceToolStripMenuItem.Checked;
            btnSwitchPicBox.Visible = !advancedInterfaceToolStripMenuItem.Checked;
            advancedInterfaceToolStripMenuItem.Checked = !advancedInterfaceToolStripMenuItem.Checked;

            if (!advancedInterfaceToolStripMenuItem.Checked)
                if (btnSwitchPicBox.Text == "QR Code")
                    btnSwitchPicBox_Click(sender, e);
        }

        private void aboutToolStripMenuItem_Click(object sender, EventArgs e)
        {
            AboutBox1 box = new AboutBox1();
            box.ShowDialog();
        }

        private void cboRegion_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            if (cboRegion.SelectedIndex == 1)
            {
                hexBox1.ByteProvider.WriteByte(0x00, 0x62);
                hexBox1.ByteProvider.WriteByte(0x01, 0x00);
                hexBox1.ByteProvider.WriteByte(0x02, 0x58);
                hexBox1.ByteProvider.WriteByte(0x03, 0x00);
                hexBox1.ByteProvider.WriteByte(0x04, 0x38);
                hexBox1.ByteProvider.WriteByte(0x05, 0x00);
                hexBox1.ByteProvider.WriteByte(0x06, 0x30);
                hexBox1.ByteProvider.WriteByte(0x07, 0x00);
            }
            else if (cboRegion.SelectedIndex == 0)
            {
                hexBox1.ByteProvider.WriteByte(0x00, 0x41);
                hexBox1.ByteProvider.WriteByte(0x01, 0x00);
                hexBox1.ByteProvider.WriteByte(0x02, 0x68);
                hexBox1.ByteProvider.WriteByte(0x03, 0x00);
                hexBox1.ByteProvider.WriteByte(0x04, 0x34);
                hexBox1.ByteProvider.WriteByte(0x05, 0x00);
                hexBox1.ByteProvider.WriteByte(0x06, 0x33);
                hexBox1.ByteProvider.WriteByte(0x07, 0x00);
            }
            else
            {
                hexBox1.ByteProvider.WriteByte(0x00, 0x6A);
                hexBox1.ByteProvider.WriteByte(0x01, 0x00);
                hexBox1.ByteProvider.WriteByte(0x02, 0x33);
                hexBox1.ByteProvider.WriteByte(0x03, 0x00);
                hexBox1.ByteProvider.WriteByte(0x04, 0x5A);
                hexBox1.ByteProvider.WriteByte(0x05, 0x00);
                hexBox1.ByteProvider.WriteByte(0x06, 0x77);
                hexBox1.ByteProvider.WriteByte(0x07, 0x00);
            }
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
        }

        private void cboStats_SelectedIndexChanged(object sender, EventArgs e)
        {
            if (populating) return;
            int stat_index = cboStats.SelectedIndex;
            int antenna_index = cboAntennaPower.SelectedIndex;
            if (stat_index == -1) return;
            if (antenna_index == -1) { StatusStripLabel.Text = "Antenna Power required"; return; }
            if (intStats[antenna_index] == null) return;
            nudStats.Value = intStats[antenna_index][stat_index];
        }

        private void populate_combo_boxes(Byte[] byteArray)
        {
            populating = true;
            cboRegion.SelectedIndex = IsQRDenpa(byteArray);
            Application.DoEvents();
            populating = false;
        }

        private void captureQRCodeToolStripMenuItem_Click(object sender, EventArgs e)
        {
            var byteArray = CameraCapture.GetByteArray(true);
            if (byteArray != null)
            {
                QRByteArray = decrypt_byte_array(byteArray);
                if (IsQRDenpa(byteArray) == -1)
                {
                    MessageBox.Show("Error: Scanned QR code is not recognized as a Denpa men QR code");
                    return;
                }
                if (hexBox1.ByteProvider != null)
                {
                    IDisposable byteProvider = hexBox1.ByteProvider as IDisposable;
                    if (byteProvider != null)
                        byteProvider.Dispose();
                    hexBox1.ByteProvider = null;
                }
                hexBox1.ByteProvider = new Be.Windows.Forms.DynamicByteProvider(QRByteArray);
                hexBox1_KeyPress(sender, null);

                populate_combo_boxes(byteArray);
                var temp = new byte[0];
                temp = new Byte[QRByteArray.Length];
                QRByteArray.CopyTo(temp, 0);    //Make sure any tampering with the combo boxes do NOT mess with this data.
            }

        }

        private void toolStripTextBox1_Click_1(object sender, EventArgs e)
        {
            newDenpaToolStripMenuItem_Click(sender, e);
            cboRegion.SelectedIndex = 0;
            cboRegion_SelectedIndexChanged(sender, e);
            hexBox1.ByteProvider.WriteByte(0x36, 0x00);
            hexBox1.ByteProvider.WriteByte(0x37, 0x00);

            int j = 0xFF;
            int k = 0;
            int l = 0;

            do
            {
                k = 0;
                for (int i = 0; i < 256; i++)
                    if (Encryption_Table[j][i] > -1)
                        k++;
                if (k == 256) { j++; l++; if (j == 256) { j = 0; } }
            } while ((k == 256) && (l < 256));
            if (l == 256) return;
            l = 0;

            for (int i = 0x0C; i < 0x64; i += 2)
            {
                if (i == 0x36) continue;
                hexBox1.ByteProvider.WriteByte(i, (Byte)j);
                hexBox1.ByteProvider.WriteByte(i + 1, 0);
            }
            hexBox1.Refresh();
            hexBox1_KeyPress(null, null);
            Application.DoEvents();



            while (k != 256)
            {
                StatusStripLabel.Text = "Working on Encryption Table 0x" + (j).ToString("X2") + ", " + (128 - (k/2)).ToString() + 
                    " Values left, tried " + l.ToString() + " QR codes";
                var byteArray = CameraCapture.GetByteArray(true);
                if (byteArray != null)
                {
                    for (int i = 0x0C; i < 0x64; i += 2)
                        if (Encryption_Table[j][byteArray[i + 1] & 0x7F] == -1)
                        {
                            if (i == 0x36) continue;
                            Encryption_Table[j][byteArray[i + 1] & 0x7F] = byteArray[i];
                            Encryption_Table[j][(byteArray[i + 1] & 0x7F) | 0x80] = byteArray[i]; 
                            k+=2;
                        }
                }
                else
                    break;
                l++;
            }
            statusStrip.Text = "Capture of data complete. :)";
            String dec_table = "            Encryption_Table[0x" + j.ToString("X2") + "] = new Int16[256] { ";
            for (int i = 0; i < 256; i++)
            {
                if ((i % 16) == 0)
                    dec_table += "\n                ";
                if (Encryption_Table[j][i] >= 0)
                    dec_table += "0x" + Encryption_Table[j][i].ToString("X2") + ", ";
                else
                    dec_table += "-1,   ";
            }
            dec_table += "\n            };\n";
            richTextBox1.Text += dec_table;
            richTextBox1.Visible = true;
            picBox2.Visible = false;
            //And for knowen Ecryption table values, populate the decryption table.
            for (int i = 0; i < 256; i++)
                for (j = 0; j < 256; j++)
                {
                    if (Encryption_Table[i][j] >= 0)
                        Decryption_Table[Encryption_Table[i][j]][j] = (Byte)i;
                }
        }
    }
}
